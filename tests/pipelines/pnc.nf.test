nextflow_pipeline {
    name "PNC Tests for Arborator Pipeline"
    script "main.nf"

    test("Outbreak Confirmation"){
        tag "pnc"
        tag "pnc_outbreak_confirmation"

        config "$baseDir/tests/data/pnc/outbreak-confirmation/nextflow.config"

        when {
            params {
                input = "$baseDir/tests/data/pnc/outbreak-confirmation/samplesheet.csv"
                outdir = "results"

                ar_config = "$baseDir/tests/data/pnc/outbreak-confirmation/arborator.config.json"
                ar_thresholds = "30,25,20,15,10,5"

                tree_distances = "cophenetic"
            }
        }

        then {
            assert workflow.success
            assert path("$launchDir/results").exists()

            // Check that files exist:
            def arborator_1_clusters = path("$launchDir/results/arborator/1_clusters.tsv")
            def arborator_1_loci = path("$launchDir/results/arborator/1_loci.summary.tsv")
            def arborator_1_matrix = path("$launchDir/results/arborator/1_matrix.tsv")
            def arborator_1_metadata = path("$launchDir/results/arborator/1_metadata.tsv")
            def arborator_1_outliers = path("$launchDir/results/arborator/1_outliers.tsv")
            def arborator_1_profile = path("$launchDir/results/arborator/1_profile.tsv")
            def arborator_1_tree = path("$launchDir/results/arborator/1_tree.nwk")

            assert arborator_1_clusters.exists()
            assert arborator_1_loci.exists()
            assert arborator_1_matrix.exists()
            assert arborator_1_metadata.exists()
            assert arborator_1_outliers.exists()
            assert arborator_1_profile.exists()
            assert arborator_1_tree.exists()

            def arborator_2_clusters = path("$launchDir/results/arborator/2_clusters.tsv")
            def arborator_2_loci = path("$launchDir/results/arborator/2_loci.summary.tsv")
            def arborator_2_matrix = path("$launchDir/results/arborator/2_matrix.tsv")
            def arborator_2_metadata = path("$launchDir/results/arborator/2_metadata.tsv")
            def arborator_2_outliers = path("$launchDir/results/arborator/2_outliers.tsv")
            def arborator_2_profile = path("$launchDir/results/arborator/2_profile.tsv")
            def arborator_2_tree = path("$launchDir/results/arborator/2_tree.nwk")

            assert arborator_2_clusters.exists()
            assert arborator_2_loci.exists()
            assert arborator_2_matrix.exists()
            assert arborator_2_metadata.exists()
            assert arborator_2_outliers.exists()
            assert arborator_2_profile.exists()
            assert arborator_2_tree.exists()

            def arborator_3_clusters = path("$launchDir/results/arborator/3_clusters.tsv")
            def arborator_3_loci = path("$launchDir/results/arborator/3_loci.summary.tsv")
            def arborator_3_matrix = path("$launchDir/results/arborator/3_matrix.tsv")
            def arborator_3_metadata = path("$launchDir/results/arborator/3_metadata.tsv")
            def arborator_3_outliers = path("$launchDir/results/arborator/3_outliers.tsv")
            def arborator_3_profile = path("$launchDir/results/arborator/3_profile.tsv")
            def arborator_3_tree = path("$launchDir/results/arborator/3_tree.nwk")

            assert arborator_3_clusters.exists()
            assert arborator_3_loci.exists()
            assert arborator_3_matrix.exists()
            assert arborator_3_metadata.exists()
            assert arborator_3_outliers.exists()
            assert arborator_3_profile.exists()
            assert arborator_3_tree.exists()

            def arborator_4_clusters = path("$launchDir/results/arborator/4_clusters.tsv")
            def arborator_4_loci = path("$launchDir/results/arborator/4_loci.summary.tsv")
            def arborator_4_matrix = path("$launchDir/results/arborator/4_matrix.tsv")
            def arborator_4_metadata = path("$launchDir/results/arborator/4_metadata.tsv")
            def arborator_4_outliers = path("$launchDir/results/arborator/4_outliers.tsv")
            def arborator_4_profile = path("$launchDir/results/arborator/4_profile.tsv")
            def arborator_4_tree = path("$launchDir/results/arborator/4_tree.nwk")

            assert arborator_4_clusters.exists()
            assert arborator_4_loci.exists()
            assert arborator_4_matrix.exists()
            assert arborator_4_metadata.exists()
            assert arborator_4_outliers.exists()
            assert arborator_4_profile.exists()
            assert arborator_4_tree.exists()

            def arborator_5_clusters = path("$launchDir/results/arborator/5_clusters.tsv")
            def arborator_5_loci = path("$launchDir/results/arborator/5_loci.summary.tsv")
            def arborator_5_matrix = path("$launchDir/results/arborator/5_matrix.tsv")
            def arborator_5_metadata = path("$launchDir/results/arborator/5_metadata.tsv")
            def arborator_5_outliers = path("$launchDir/results/arborator/5_outliers.tsv")
            def arborator_5_profile = path("$launchDir/results/arborator/5_profile.tsv")
            def arborator_5_tree = path("$launchDir/results/arborator/5_tree.nwk")

            assert arborator_5_clusters.exists()
            assert arborator_5_loci.exists()
            assert arborator_5_matrix.exists()
            assert arborator_5_metadata.exists()
            assert arborator_5_outliers.exists()
            assert arborator_5_profile.exists()
            assert arborator_5_tree.exists()

            def arborator_6_clusters = path("$launchDir/results/arborator/6_clusters.tsv")
            def arborator_6_loci = path("$launchDir/results/arborator/6_loci.summary.tsv")
            def arborator_6_matrix = path("$launchDir/results/arborator/6_matrix.tsv")
            def arborator_6_metadata = path("$launchDir/results/arborator/6_metadata.tsv")
            def arborator_6_outliers = path("$launchDir/results/arborator/6_outliers.tsv")
            def arborator_6_profile = path("$launchDir/results/arborator/6_profile.tsv")
            def arborator_6_tree = path("$launchDir/results/arborator/6_tree.nwk")

            assert arborator_6_clusters.exists()
            assert arborator_6_loci.exists()
            assert arborator_6_matrix.exists()
            assert arborator_6_metadata.exists()
            assert arborator_6_outliers.exists()
            assert arborator_6_profile.exists()
            assert arborator_6_tree.exists()

            def arborator_7_clusters = path("$launchDir/results/arborator/7_clusters.tsv")
            def arborator_7_loci = path("$launchDir/results/arborator/7_loci.summary.tsv")
            def arborator_7_matrix = path("$launchDir/results/arborator/7_matrix.tsv")
            def arborator_7_metadata = path("$launchDir/results/arborator/7_metadata.tsv")
            def arborator_7_outliers = path("$launchDir/results/arborator/7_outliers.tsv")
            def arborator_7_profile = path("$launchDir/results/arborator/7_profile.tsv")
            def arborator_7_tree = path("$launchDir/results/arborator/7_tree.nwk")

            assert arborator_7_clusters.exists()
            assert arborator_7_loci.exists()
            assert arborator_7_matrix.exists()
            assert arborator_7_metadata.exists()
            assert arborator_7_outliers.exists()
            assert arborator_7_profile.exists()
            assert arborator_7_tree.exists()

            def arborator_8_clusters = path("$launchDir/results/arborator/8_clusters.tsv")
            def arborator_8_loci = path("$launchDir/results/arborator/8_loci.summary.tsv")
            def arborator_8_matrix = path("$launchDir/results/arborator/8_matrix.tsv")
            def arborator_8_metadata = path("$launchDir/results/arborator/8_metadata.tsv")
            def arborator_8_outliers = path("$launchDir/results/arborator/8_outliers.tsv")
            def arborator_8_profile = path("$launchDir/results/arborator/8_profile.tsv")
            def arborator_8_tree = path("$launchDir/results/arborator/8_tree.nwk")

            assert arborator_8_clusters.exists()
            assert arborator_8_loci.exists()
            assert arborator_8_matrix.exists()
            assert arborator_8_metadata.exists()
            assert arborator_8_outliers.exists()
            assert arborator_8_profile.exists()
            assert arborator_8_tree.exists()

            def arborator_9_clusters = path("$launchDir/results/arborator/9_clusters.tsv")
            def arborator_9_loci = path("$launchDir/results/arborator/9_loci.summary.tsv")
            def arborator_9_matrix = path("$launchDir/results/arborator/9_matrix.tsv")
            def arborator_9_metadata = path("$launchDir/results/arborator/9_metadata.tsv")
            def arborator_9_outliers = path("$launchDir/results/arborator/9_outliers.tsv")
            def arborator_9_profile = path("$launchDir/results/arborator/9_profile.tsv")
            def arborator_9_tree = path("$launchDir/results/arborator/9_tree.nwk")

            assert arborator_9_clusters.exists()
            assert arborator_9_loci.exists()
            assert arborator_9_matrix.exists()
            assert arborator_9_metadata.exists()
            assert arborator_9_outliers.exists()
            assert arborator_9_profile.exists()
            assert arborator_9_tree.exists()

            def arborator_10_clusters = path("$launchDir/results/arborator/10_clusters.tsv")
            def arborator_10_loci = path("$launchDir/results/arborator/10_loci.summary.tsv")
            def arborator_10_matrix = path("$launchDir/results/arborator/10_matrix.tsv")
            def arborator_10_metadata = path("$launchDir/results/arborator/10_metadata.tsv")
            def arborator_10_outliers = path("$launchDir/results/arborator/10_outliers.tsv")
            def arborator_10_profile = path("$launchDir/results/arborator/10_profile.tsv")
            def arborator_10_tree = path("$launchDir/results/arborator/10_tree.nwk")

            assert arborator_10_clusters.exists()
            assert arborator_10_loci.exists()
            assert arborator_10_matrix.exists()
            assert arborator_10_metadata.exists()
            assert arborator_10_outliers.exists()
            assert arborator_10_profile.exists()
            assert arborator_10_tree.exists()

            def cluster_summary = path("$launchDir/results/arborator/cluster_summary.tsv")
            def cluster_summary_xlsx = path("$launchDir/results/arborator/cluster_summary.xlsx")
            def metadata_excluded = path("$launchDir/results/arborator/metadata.excluded.tsv")
            def metadata_included = path("$launchDir/results/arborator/metadata.included.tsv")
            def metadata_linelist = path("$launchDir/results/arborator/metadata.linelist.xlsx")
            def run_json = path("$launchDir/results/arborator/run.json")
            def threshold_map = path("$launchDir/results/arborator/threshold_map.json")

            assert cluster_summary.exists()
            assert cluster_summary_xlsx.exists()
            assert metadata_excluded.exists()
            assert metadata_included.exists()
            assert metadata_linelist.exists()
            assert run_json.exists()
            assert threshold_map.exists()

            def arborview_1 = path("$launchDir/results/arborview/1_arborview.html")
            def arborview_2 = path("$launchDir/results/arborview/2_arborview.html")
            def arborview_3 = path("$launchDir/results/arborview/3_arborview.html")
            def arborview_4 = path("$launchDir/results/arborview/4_arborview.html")
            def arborview_5 = path("$launchDir/results/arborview/5_arborview.html")
            def arborview_6 = path("$launchDir/results/arborview/6_arborview.html")
            def arborview_7 = path("$launchDir/results/arborview/7_arborview.html")
            def arborview_8 = path("$launchDir/results/arborview/8_arborview.html")
            def arborview_9 = path("$launchDir/results/arborview/9_arborview.html")
            def arborview_10 = path("$launchDir/results/arborview/10_arborview.html")

            assert arborview_1.exists()
            assert arborview_2.exists()
            assert arborview_3.exists()
            assert arborview_4.exists()
            assert arborview_5.exists()
            assert arborview_6.exists()
            assert arborview_7.exists()
            assert arborview_8.exists()
            assert arborview_9.exists()
            assert arborview_10.exists()

            def iridanext_output = path("$launchDir/results/iridanext.output.json")

            assert iridanext_output.exists()

            // Irida Next Output:
            def iridanext_json = iridanext_output.json
            def iridanext_global = iridanext_json.files.global
            def iridanext_samples = iridanext_json.files.samples
            def iridanext_metadata = iridanext_json.metadata.samples

            assert iridanext_global.findAll { it.path == "arborator/1_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/3_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/3_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/3_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/3_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/3_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/3_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/3_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/4_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/4_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/4_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/4_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/4_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/4_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/4_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/5_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/6_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/6_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/6_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/6_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/6_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/6_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/6_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/7_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/7_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/7_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/7_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/7_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/7_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/7_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/8_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/8_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/8_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/8_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/8_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/8_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/8_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/9_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/9_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/9_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/9_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/9_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/9_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/9_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/10_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/cluster_summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/cluster_summary.xlsx" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.excluded.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.included.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.linelist.xlsx" }.size() == 1

            // Check Clusters
            assert arborator_1_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_1_clusters.text.contains("0_ingroup_0\t1|1.1.1.2.3.4")
            assert arborator_1_clusters.text.contains("0_ingroup_1\t1|1.1.1.2.2.3")
            assert arborator_1_clusters.text.contains("0_ingroup_2\t1|1.1.1.1.1.1")
            assert arborator_1_clusters.text.contains("0_ingroup_3\t1|1.1.1.2.2.3")
            assert arborator_1_clusters.text.contains("0_ingroup_4\t1|1.1.1.1.1.2")

            assert arborator_2_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2_clusters.text.contains("1_ingroup_10\t2|1.1.1.1.2.3")
            assert arborator_2_clusters.text.contains("1_ingroup_11\t2|1.1.1.1.3.4")
            assert arborator_2_clusters.text.contains("1_ingroup_12\t2|1.1.1.1.1.1")
            assert arborator_2_clusters.text.contains("1_ingroup_13\t2|1.1.1.1.4.5")
            assert arborator_2_clusters.text.contains("1_ingroup_14\t2|1.1.1.1.1.2")

            assert arborator_3_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_3_clusters.text.contains("2_ingroup_20\t3|1.1.1.1.1.1")
            assert arborator_3_clusters.text.contains("2_ingroup_21\t3|1.1.1.2.2.3")
            assert arborator_3_clusters.text.contains("2_ingroup_22\t3|1.1.1.1.1.2")
            assert arborator_3_clusters.text.contains("2_ingroup_23\t3|1.1.1.2.2.4")
            assert arborator_3_clusters.text.contains("2_ingroup_24\t3|1.1.1.2.2.5")

            assert arborator_4_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_4_clusters.text.contains("3_ingroup_30\t4|1.1.1.1.1.1")
            assert arborator_4_clusters.text.contains("3_ingroup_31\t4|1.1.1.2.2.3")
            assert arborator_4_clusters.text.contains("3_ingroup_32\t4|1.1.1.1.1.2")
            assert arborator_4_clusters.text.contains("3_ingroup_33\t4|1.1.1.1.1.1")
            assert arborator_4_clusters.text.contains("3_ingroup_34\t4|1.1.1.2.3.4")

            assert arborator_5_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_5_clusters.text.contains("4_ingroup_40\t5|1.1.1.1.1.1")
            assert arborator_5_clusters.text.contains("4_ingroup_41\t5|1.1.1.1.2.3")
            assert arborator_5_clusters.text.contains("4_ingroup_42\t5|1.1.1.1.1.2")
            assert arborator_5_clusters.text.contains("4_ingroup_43\t5|1.1.1.1.2.4")
            assert arborator_5_clusters.text.contains("4_ingroup_44\t5|1.1.1.1.1.1")

            assert arborator_6_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_6_clusters.text.contains("5_ingroup_50\t6|1.1.1.1.1.1")
            assert arborator_6_clusters.text.contains("5_ingroup_51\t6|1.1.1.1.1.2")
            assert arborator_6_clusters.text.contains("5_ingroup_52\t6|1.1.1.1.1.1")
            assert arborator_6_clusters.text.contains("5_ingroup_53\t6|1.1.1.1.2.3")
            assert arborator_6_clusters.text.contains("5_ingroup_54\t6|1.1.1.1.2.4")

            assert arborator_7_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_7_clusters.text.contains("6_ingroup_60\t7|1.1.1.1.2.3")
            assert arborator_7_clusters.text.contains("6_ingroup_61\t7|1.1.1.1.2.3")
            assert arborator_7_clusters.text.contains("6_ingroup_62\t7|1.1.1.1.1.1")
            assert arborator_7_clusters.text.contains("6_ingroup_63\t7|1.1.1.1.1.2")
            assert arborator_7_clusters.text.contains("6_ingroup_64\t7|1.1.1.1.3.4")

            assert arborator_8_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_8_clusters.text.contains("7_ingroup_70\t8|1.1.1.1.1.1")
            assert arborator_8_clusters.text.contains("7_ingroup_71\t8|1.1.1.1.1.2")
            assert arborator_8_clusters.text.contains("7_ingroup_72\t8|1.1.1.1.2.3")
            assert arborator_8_clusters.text.contains("7_ingroup_73\t8|1.1.1.1.2.4")
            assert arborator_8_clusters.text.contains("7_ingroup_74\t8|1.1.1.1.1.1")

            assert arborator_9_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_9_clusters.text.contains("8_ingroup_80\t9|1.1.1.1.1.1")
            assert arborator_9_clusters.text.contains("8_ingroup_81\t9|1.1.1.1.1.1")
            assert arborator_9_clusters.text.contains("8_ingroup_82\t9|1.1.1.1.1.1")
            assert arborator_9_clusters.text.contains("8_ingroup_83\t9|1.1.1.1.1.3")
            assert arborator_9_clusters.text.contains("8_ingroup_84\t9|1.1.1.1.1.2")

            assert arborator_10_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_10_clusters.text.contains("9_ingroup_90\t10|1.1.1.1.1.1")
            assert arborator_10_clusters.text.contains("9_ingroup_91\t10|1.1.1.2.2.5")
            assert arborator_10_clusters.text.contains("9_ingroup_92\t10|1.1.1.2.2.3")
            assert arborator_10_clusters.text.contains("9_ingroup_93\t10|1.1.1.2.2.4")
            assert arborator_10_clusters.text.contains("9_ingroup_94\t10|1.1.1.1.1.2")

            // Cluster Summary
            assert cluster_summary.text.contains("provisional_outbreak_code_values\tnational_outbreak_code_values\tnational_outbreak_status_values\tcnphi_post_date_min_value\tcnphi_post_date_max_value\tgenomic_address_name_values\tpredicted_identification_name_values\tpredicted_primary_type_name_values\tcount_members\tmin_dist\tmedian_dist\tmean_dist \tmax_dist\tcount_outliers\toutlier_ids\tcalc_earliest_date_min_value\tcalc_earliest_date_max_value\tcount_calc_source_type_animal\tcount_calc_source_type_environmental\tcount_calc_source_type_food\tcount_calc_source_type_human\tcount_calc_source_type_unknown\tgeo_loc_name_state_province_territory_values\tcount_geo_loc_name_state_province_territory_Alberta\tcount_geo_loc_name_state_province_territory_British Columbia\tcount_geo_loc_name_state_province_territory_Manitoba\tcount_geo_loc_name_state_province_territory_New Brunswick\tcount_geo_loc_name_state_province_territory_Newfoundland and Labrador\tcount_geo_loc_name_state_province_territory_Nova Scotia\tcount_geo_loc_name_state_province_territory_Northwest Territories\tcount_geo_loc_name_state_province_territory_Nunavut\tcount_geo_loc_name_state_province_territory_Ontario\tcount_geo_loc_name_state_province_territory_Prince Edward Island\tcount_geo_loc_name_state_province_territory_Quebec\tcount_geo_loc_name_state_province_territory_Saskatchewan\tcount_geo_loc_name_state_province_territory_Yukon")
            assert cluster_summary.text.contains("1\t2501STWGS-01\tclosed\t2025-01-10\t2025-01-10\t1.1.1.1\tSalmonella enterica subsp. enterica\tTyphimurium\t5\t2.0\t15.0\t13.4\t18.0\t0\t\t2025-01-01\t2025-01-05\t1\t1\t1\t2\t0\tAlberta,British Columbia,Manitoba,Ontario,Saskatchewan\t1\t1\t1\t0\t0\t0\t0\t0\t1\t0\t0\t1\t0")
            assert cluster_summary.text.contains("2\t2502SEWGS-01\tclosed\t2025-02-07\t2025-03-07\t1.1.2.2\tSalmonella enterica subsp. enterica\tEnteritidis\t5\t10.0\t13.0\t13.6\t20.0\t0\t\t2025-02-01\t2025-03-01\t1\t0\t1\t3\t0\tAlberta,British Columbia,Northwest Territories,Nunavut,Yukon\t1\t1\t0\t0\t0\t0\t1\t1\t0\t0\t0\t0\t1")
            assert cluster_summary.text.contains("3\t2503SHWGS-01\tclosed\t2025-03-07\t2025-03-28\t10.10.10.10\tSalmonella enterica\tHeidelberg\t5\t6.0\t13.5\t12.2\t17.0\t0\t\t2025-03-17\t2025-03-22\t1\t1\t2\t1\t0\tNew Brunswick,Ontario,Quebec\t0\t0\t0\t1\t0\t0\t0\t0\t2\t0\t2\t0\t0")
            assert cluster_summary.text.contains("4\t2504SAL-01\tclosed\t2025-04-11\t2025-05-02\t2.4.4.4\tSalmonella arizonae\tIIIa 51:z36:-\t5\t2.0\t13.5\t12.0\t18.0\t0\t\t2025-04-05\t2025-04-24\t1\t2\t1\t1\t0\tNew Brunswick,Nova Scotia,Prince Edward Island,Quebec,Yukon\t0\t0\t0\t1\t0\t1\t0\t0\t0\t1\t1\t0\t1")
            assert cluster_summary.text.contains("5\t2505SAL-01\topen\t2025-05-09\t2025-05-23\t5.5.5.21000\tSalmonella enterica,Salmonella arizonae\tI 1,2,12:a:[1,5]|I 1,2,12:a:-\t5\t2.0\t9.5\t9.4\t13.0\t0\t\t2025-05-12\t2025-05-15\t1\t2\t2\t0\t0\tAlberta,Newfoundland and Labrador,Nova Scotia,Nunavut,Prince Edward Island\t1\t0\t0\t0\t1\t1\t0\t1\t0\t1\t0\t0\t0")
            assert cluster_summary.text.contains("6\t2506SAL-01\tclosed\t2025-06-06\t2025-06-27\t1.3.3.3\tSalmonella enterica\tI 1,4,12,27:z41:1,(2),5\t5\t3.0\t9.0\t9.0\t13.0\t0\t\t2025-06-02\t2025-06-21\t1\t1\t1\t2\t0\tNewfoundland and Labrador,Northwest Territories,Nova Scotia,Prince Edward Island,Yukon\t0\t0\t0\t0\t1\t1\t1\t0\t0\t1\t0\t0\t1")
            assert cluster_summary.text.contains("7\t2507monoSTWGS-01\topen\t2025-07-11\t2025-07-18\t70.70.90.110\tSalmonella enterica\tI 1,4,[5],12:i:-\t5\t5.0\t12.5\t12.0\t19.0\t0\t\t2025-07-07\t2025-07-25\t1\t1\t1\t2\t0\tAlberta,British Columbia,Manitoba,Ontario,Saskatchewan\t1\t1\t1\t0\t0\t0\t0\t0\t1\t0\t0\t1\t0")
            assert cluster_summary.text.contains("8\t2509SAL-01\topen\t2025-09-05\t2025-09-19\t5000.5000.5000.10000\tSalmonella arizonae\tIIIa 17:g,z51:-\t5\t4.0\t10.0\t9.4\t12.0\t0\t\t2025-08-26\t2025-09-04\t1\t0\t0\t4\t0\tNewfoundland and Labrador,Northwest Territories,Nunavut,Prince Edward Island,Yukon\t0\t0\t0\t0\t1\t0\t1\t1\t0\t1\t0\t0\t1")
            assert cluster_summary.text.contains("9\t2509SAL-02\topen\t2025-09-05\t2025-09-19\t999.1000.1000.5000\tSalmonella bongori\tV 51:y:1,2\t5\t4.0\t7.5\t7.2\t13.0\t0\t\t2025-09-18\t2025-09-29\t1\t0\t0\t4\t0\tAlberta,British Columbia,Manitoba,Ontario,Quebec\t1\t1\t1\t0\t0\t0\t0\t0\t1\t0\t1\t0\t0")
            assert cluster_summary.text.contains("10\t2511InfantisWGS-01\topen\t2025-11-07\t2025-12-05\t100.200.300.400\tSalmonella enterica\tInfantis\t5\t6.0\t12.5\t13.2\t24.0\t0\t\t2025-11-01\t2025-11-27\t1\t1\t1\t2\t0\tManitoba,New Brunswick,Ontario,Quebec,Saskatchewan\t0\t0\t1\t1\t0\t0\t0\t0\t1\t0\t1\t1\t0")

            // Metadata Included (subset):
            assert metadata_included.text.contains("sample_name\tnew_isolates_date\tgas_denovo_cluster_address\tprovisional_outbreak_code\tnational_outbreak_code\tnational_outbreak_status\tnational_outbreak_date_assigned\talternative_isolate_id\tgeo_loc_name_state_province_territory\tpredicted_identification_name\tpredicted_primary_type_name\tcalc_earliest_date\tcalc_source_type\tanatomical_material\tanatomical_part\tbody_product\toriginal_sample_description\tcalc_host_age\thost_gender\thost_date_of_birth_dob\trelated_specimen_primary_id\trelated_specimen_relationship_type\tcomments\tfastmatch_result\tcnphi_post_date\tgenomic_address_name\tsample_puid")
            assert metadata_included.text.contains("0_ingroup_0\t2025-01-07\t1|1.1.1.2.3.4\t1\t2501STWGS-01\tclosed\t2025-01-10\t1\tAlberta\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-01\tHuman\tBlood\tNot Provided\tNot Provided\tHuman;Blood;Not Provided;Not Provided\t78\tFemale\t1947-01-21\tNot Applicable\tNot Applicable\t(?? Salmonella)\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA01")
            assert metadata_included.text.contains("0_ingroup_1\t2025-01-07\t1|1.1.1.2.2.3\t1\t2501STWGS-01\tclosed\t2025-01-10\t2\tBritish Columbia\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-02\tHuman\tNot Provided\tNot Applicable\tFeces\tHuman;Not Provided;Not Applicable;Feces\t85\tFemale\t1940-01-24\tNot Applicable\tNot Applicable\t2025\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA02")
            assert metadata_included.text.contains("0_ingroup_2\t2025-01-07\t1|1.1.1.1.1.1\t1\t2501STWGS-01\tclosed\t2025-01-09\t3\tSaskatchewan\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-03\tAnimal\tNot Provided\tSpleen\tNot Provided\tAnimal;Not Provided;Spleen;Not Provided\t\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tXdr; 2025\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA03")
            assert metadata_included.text.contains("0_ingroup_3\t2025-01-07\t1|1.1.1.2.2.3\t1\t2501STWGS-01\tclosed\t2025-01-09\t4\tManitoba\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-04\tFood\tNot Applicable\tNot Applicable\tNot Applicable\tFood;Not Applicable;Not Applicable;Not Applicable\t\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tPT Resident\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA04")
            assert metadata_included.text.contains("0_ingroup_4\t2025-01-07\t1|1.1.1.1.1.2\t1\t2501STWGS-01\tclosed\t2025-01-10\t5\tOntario\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-05\tEnvironmental\tNot Applicable\tNot Provided\tNot Provided\tEnvironmental;Not Applicable;Not Provided;Not Provided\t\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\t~11 alleles from others\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA05")
            assert metadata_included.text.contains("1_ingroup_10\t2025-02-04\t2|1.1.1.1.2.3\t2\t2502SEWGS-01\tclosed\t2025-02-07\t11.42529704\tYukon\tSalmonella enterica subsp. enterica\tEnteritidis\t2025-02-01\tHuman\tBlood\tNot Provided\tNot Provided\tHuman;Blood;Not Provided;Not Provided\t33\tMale\t1992-02-10\tNot Applicable\tNot Applicable\t2025\t\t2025-02-07\t1.1.2.2\tINXT_SAM_AAAAAAAAA11")
            assert metadata_included.text.contains("1_ingroup_11\t2025-02-11\t2|1.1.1.1.3.4\t2\t2502SEWGS-01\tclosed\t2025-02-12\t12.93911574\tNorthwest Territories\tSalmonella enterica subsp. enterica\tEnteritidis\t2025-02-08\tHuman\tNot Provided\tLung\tFeces\tHuman;Not Provided;Lung;Feces\t60\tMale\t1965-02-23\tNot Applicable\tNot Applicable\tXdr; 2025\t\t2025-02-14\t1.1.2.2\tINXT_SAM_AAAAAAAAA12")
            assert metadata_included.text.contains("1_ingroup_12\t2025-02-18\t2|1.1.1.1.1.1\t2\t2502SEWGS-01\tclosed\t2025-02-21\t13.11566743\tNunavut\tSalmonella enterica subsp. enterica\tEnteritidis\t2025-02-14\tAnimal\tNot Applicable\tSpleen\tNot Provided\tAnimal;Not Applicable;Spleen;Not Provided\t\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tPT Resident\t\t2025-02-21\t1.1.2.2\tINXT_SAM_AAAAAAAAA13")
            assert metadata_included.text.contains("1_ingroup_13\t2025-02-25\t2|1.1.1.1.4.5\t2\t2502SEWGS-01\tclosed\t2025-02-27\t14.62079496\tAlberta\tSalmonella enterica subsp. enterica\tEnteritidis\t2025-02-24\tFood\tNot Applicable\tNot Applicable\tNot Applicable\tFood;Not Applicable;Not Applicable;Not Applicable\t\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\t~11 alleles from others\t\t2025-02-28\t1.1.2.2\tINXT_SAM_AAAAAAAAA14")

            // Trees
            assert arborator_1_tree.text.contains("((0_ingroup_2:10.0,0_ingroup_4:10.0):5.666666666666666,(0_ingroup_0:14.0,(0_ingroup_1:2.0,0_ingroup_3:2.0):12.0):1.666666666666666);")
            assert arborator_2_tree.text.contains("((1_ingroup_12:10.0,1_ingroup_14:10.0):4.666666666666666,(1_ingroup_13:13.5,(1_ingroup_10:11.0,1_ingroup_11:11.0):2.5):1.166666666666666);")
            assert arborator_3_tree.text.contains("((2_ingroup_20:7.0,2_ingroup_22:7.0):8.166666666666666,(2_ingroup_24:9.0,(2_ingroup_21:6.0,2_ingroup_23:6.0):3.0):6.166666666666666);")
            assert arborator_4_tree.text.contains("((3_ingroup_32:7.0,(3_ingroup_30:2.0,3_ingroup_33:2.0):5.0):8.5,(3_ingroup_31:11.0,3_ingroup_34:11.0):4.5);")
            assert arborator_5_tree.text.contains("((4_ingroup_42:8.0,(4_ingroup_40:2.0,4_ingroup_44:2.0):6.0):3.0,(4_ingroup_41:10.0,4_ingroup_43:10.0):1.0);")
            assert arborator_6_tree.text.contains("((5_ingroup_51:7.5,(5_ingroup_50:3.0,5_ingroup_52:3.0):4.5):3.0,(5_ingroup_53:9.0,5_ingroup_54:9.0):1.5);")
            assert arborator_7_tree.text.contains("((6_ingroup_62:10.0,6_ingroup_63:10.0):4.0,(6_ingroup_64:10.5,(6_ingroup_60:5.0,6_ingroup_61:5.0):5.5):3.5);")
            assert arborator_8_tree.text.contains("((7_ingroup_71:9.0,(7_ingroup_70:4.0,7_ingroup_74:4.0):5.0):1.5,(7_ingroup_72:9.0,7_ingroup_73:9.0):1.5);")
            assert arborator_9_tree.text.contains("(8_ingroup_83:9.5,(8_ingroup_84:7.333333333333333,(8_ingroup_82:4.0,(8_ingroup_80:4.0,8_ingroup_81:4.0):0.0):3.333333333333333):2.166666666666667);")
            assert arborator_10_tree.text.contains("((9_ingroup_90:8.0,9_ingroup_94:8.0):8.333333333333332,(9_ingroup_91:10.0,(9_ingroup_92:6.0,9_ingroup_93:6.0):4.0):6.333333333333332);")
        }
    }

    test("Outbreak Detection"){
        tag "pnc"
        tag "pnc_outbreak_detection"

        config "$baseDir/tests/data/pnc/outbreak-detection/nextflow.config"

        when {
            params {
                input = "$baseDir/tests/data/pnc/outbreak-detection/samplesheet.csv"
                outdir = "results"

                ar_config = "$baseDir/tests/data/pnc/outbreak-detection/arborator.config.json"
                ar_thresholds = "30,25,20,15,10,5"

                tree_distances = "cophenetic"
            }
        }

        then {
            assert workflow.success
            assert path("$launchDir/results").exists()

            // Check that files exist:
            def arborator_1_1_1_1_clusters = path("$launchDir/results/arborator/1.1.1.1_clusters.tsv")
            def arborator_1_1_1_1_loci = path("$launchDir/results/arborator/1.1.1.1_loci.summary.tsv")
            def arborator_1_1_1_1_matrix = path("$launchDir/results/arborator/1.1.1.1_matrix.tsv")
            def arborator_1_1_1_1_metadata = path("$launchDir/results/arborator/1.1.1.1_metadata.tsv")
            def arborator_1_1_1_1_outliers = path("$launchDir/results/arborator/1.1.1.1_outliers.tsv")
            def arborator_1_1_1_1_profile = path("$launchDir/results/arborator/1.1.1.1_profile.tsv")
            def arborator_1_1_1_1_tree = path("$launchDir/results/arborator/1.1.1.1_tree.nwk")

            assert arborator_1_1_1_1_clusters.exists()
            assert arborator_1_1_1_1_loci.exists()
            assert arborator_1_1_1_1_matrix.exists()
            assert arborator_1_1_1_1_metadata.exists()
            assert arborator_1_1_1_1_outliers.exists()
            assert arborator_1_1_1_1_profile.exists()
            assert arborator_1_1_1_1_tree.exists()

            def arborator_1_1_2_2_clusters = path("$launchDir/results/arborator/1.1.2.2_clusters.tsv")
            def arborator_1_1_2_2_loci = path("$launchDir/results/arborator/1.1.2.2_loci.summary.tsv")
            def arborator_1_1_2_2_matrix = path("$launchDir/results/arborator/1.1.2.2_matrix.tsv")
            def arborator_1_1_2_2_metadata = path("$launchDir/results/arborator/1.1.2.2_metadata.tsv")
            def arborator_1_1_2_2_outliers = path("$launchDir/results/arborator/1.1.2.2_outliers.tsv")
            def arborator_1_1_2_2_profile = path("$launchDir/results/arborator/1.1.2.2_profile.tsv")
            def arborator_1_1_2_2_tree = path("$launchDir/results/arborator/1.1.2.2_tree.nwk")

            assert arborator_1_1_2_2_clusters.exists()
            assert arborator_1_1_2_2_loci.exists()
            assert arborator_1_1_2_2_matrix.exists()
            assert arborator_1_1_2_2_metadata.exists()
            assert arborator_1_1_2_2_outliers.exists()
            assert arborator_1_1_2_2_profile.exists()
            assert arborator_1_1_2_2_tree.exists()

            def arborator_1_3_3_3_clusters = path("$launchDir/results/arborator/1.3.3.3_clusters.tsv")
            def arborator_1_3_3_3_loci = path("$launchDir/results/arborator/1.3.3.3_loci.summary.tsv")
            def arborator_1_3_3_3_matrix = path("$launchDir/results/arborator/1.3.3.3_matrix.tsv")
            def arborator_1_3_3_3_metadata = path("$launchDir/results/arborator/1.3.3.3_metadata.tsv")
            def arborator_1_3_3_3_outliers = path("$launchDir/results/arborator/1.3.3.3_outliers.tsv")
            def arborator_1_3_3_3_profile = path("$launchDir/results/arborator/1.3.3.3_profile.tsv")
            def arborator_1_3_3_3_tree = path("$launchDir/results/arborator/1.3.3.3_tree.nwk")

            assert arborator_1_3_3_3_clusters.exists()
            assert arborator_1_3_3_3_loci.exists()
            assert arborator_1_3_3_3_matrix.exists()
            assert arborator_1_3_3_3_metadata.exists()
            assert arborator_1_3_3_3_outliers.exists()
            assert arborator_1_3_3_3_profile.exists()
            assert arborator_1_3_3_3_tree.exists()

            def arborator_2_4_4_4_clusters = path("$launchDir/results/arborator/2.4.4.4_clusters.tsv")
            def arborator_2_4_4_4_loci = path("$launchDir/results/arborator/2.4.4.4_loci.summary.tsv")
            def arborator_2_4_4_4_matrix = path("$launchDir/results/arborator/2.4.4.4_matrix.tsv")
            def arborator_2_4_4_4_metadata = path("$launchDir/results/arborator/2.4.4.4_metadata.tsv")
            def arborator_2_4_4_4_outliers = path("$launchDir/results/arborator/2.4.4.4_outliers.tsv")
            def arborator_2_4_4_4_profile = path("$launchDir/results/arborator/2.4.4.4_profile.tsv")
            def arborator_2_4_4_4_tree = path("$launchDir/results/arborator/2.4.4.4_tree.nwk")

            assert arborator_2_4_4_4_clusters.exists()
            assert arborator_2_4_4_4_loci.exists()
            assert arborator_2_4_4_4_matrix.exists()
            assert arborator_2_4_4_4_metadata.exists()
            assert arborator_2_4_4_4_outliers.exists()
            assert arborator_2_4_4_4_profile.exists()
            assert arborator_2_4_4_4_tree.exists()

            def arborator_5_5_5_21000_clusters = path("$launchDir/results/arborator/5.5.5.21000_clusters.tsv")
            def arborator_5_5_5_21000_loci = path("$launchDir/results/arborator/5.5.5.21000_loci.summary.tsv")
            def arborator_5_5_5_21000_matrix = path("$launchDir/results/arborator/5.5.5.21000_matrix.tsv")
            def arborator_5_5_5_21000_metadata = path("$launchDir/results/arborator/5.5.5.21000_metadata.tsv")
            def arborator_5_5_5_21000_outliers = path("$launchDir/results/arborator/5.5.5.21000_outliers.tsv")
            def arborator_5_5_5_21000_profile = path("$launchDir/results/arborator/5.5.5.21000_profile.tsv")
            def arborator_5_5_5_21000_tree = path("$launchDir/results/arborator/5.5.5.21000_tree.nwk")

            assert arborator_5_5_5_21000_clusters.exists()
            assert arborator_5_5_5_21000_loci.exists()
            assert arborator_5_5_5_21000_matrix.exists()
            assert arborator_5_5_5_21000_metadata.exists()
            assert arborator_5_5_5_21000_outliers.exists()
            assert arborator_5_5_5_21000_profile.exists()
            assert arborator_5_5_5_21000_tree.exists()

            def arborator_10_10_10_10_clusters = path("$launchDir/results/arborator/10.10.10.10_clusters.tsv")
            def arborator_10_10_10_10_loci = path("$launchDir/results/arborator/10.10.10.10_loci.summary.tsv")
            def arborator_10_10_10_10_matrix = path("$launchDir/results/arborator/10.10.10.10_matrix.tsv")
            def arborator_10_10_10_10_metadata = path("$launchDir/results/arborator/10.10.10.10_metadata.tsv")
            def arborator_10_10_10_10_outliers = path("$launchDir/results/arborator/10.10.10.10_outliers.tsv")
            def arborator_10_10_10_10_profile = path("$launchDir/results/arborator/10.10.10.10_profile.tsv")
            def arborator_10_10_10_10_tree = path("$launchDir/results/arborator/10.10.10.10_tree.nwk")

            assert arborator_10_10_10_10_clusters.exists()
            assert arborator_10_10_10_10_loci.exists()
            assert arborator_10_10_10_10_matrix.exists()
            assert arborator_10_10_10_10_metadata.exists()
            assert arborator_10_10_10_10_outliers.exists()
            assert arborator_10_10_10_10_profile.exists()
            assert arborator_10_10_10_10_tree.exists()

            def arborator_70_70_90_110_clusters = path("$launchDir/results/arborator/70.70.90.110_clusters.tsv")
            def arborator_70_70_90_110_loci = path("$launchDir/results/arborator/70.70.90.110_loci.summary.tsv")
            def arborator_70_70_90_110_matrix = path("$launchDir/results/arborator/70.70.90.110_matrix.tsv")
            def arborator_70_70_90_110_metadata = path("$launchDir/results/arborator/70.70.90.110_metadata.tsv")
            def arborator_70_70_90_110_outliers = path("$launchDir/results/arborator/70.70.90.110_outliers.tsv")
            def arborator_70_70_90_110_profile = path("$launchDir/results/arborator/70.70.90.110_profile.tsv")
            def arborator_70_70_90_110_tree = path("$launchDir/results/arborator/70.70.90.110_tree.nwk")

            assert arborator_70_70_90_110_clusters.exists()
            assert arborator_70_70_90_110_loci.exists()
            assert arborator_70_70_90_110_matrix.exists()
            assert arborator_70_70_90_110_metadata.exists()
            assert arborator_70_70_90_110_outliers.exists()
            assert arborator_70_70_90_110_profile.exists()
            assert arborator_70_70_90_110_tree.exists()

            def arborator_100_200_300_400_clusters = path("$launchDir/results/arborator/100.200.300.400_clusters.tsv")
            def arborator_100_200_300_400_loci = path("$launchDir/results/arborator/100.200.300.400_loci.summary.tsv")
            def arborator_100_200_300_400_matrix = path("$launchDir/results/arborator/100.200.300.400_matrix.tsv")
            def arborator_100_200_300_400_metadata = path("$launchDir/results/arborator/100.200.300.400_metadata.tsv")
            def arborator_100_200_300_400_outliers = path("$launchDir/results/arborator/100.200.300.400_outliers.tsv")
            def arborator_100_200_300_400_profile = path("$launchDir/results/arborator/100.200.300.400_profile.tsv")
            def arborator_100_200_300_400_tree = path("$launchDir/results/arborator/100.200.300.400_tree.nwk")

            assert arborator_100_200_300_400_clusters.exists()
            assert arborator_100_200_300_400_loci.exists()
            assert arborator_100_200_300_400_matrix.exists()
            assert arborator_100_200_300_400_metadata.exists()
            assert arborator_100_200_300_400_outliers.exists()
            assert arborator_100_200_300_400_profile.exists()
            assert arborator_100_200_300_400_tree.exists()

            def arborator_999_1000_1000_5000_clusters = path("$launchDir/results/arborator/999.1000.1000.5000_clusters.tsv")
            def arborator_999_1000_1000_5000_loci = path("$launchDir/results/arborator/999.1000.1000.5000_loci.summary.tsv")
            def arborator_999_1000_1000_5000_matrix = path("$launchDir/results/arborator/999.1000.1000.5000_matrix.tsv")
            def arborator_999_1000_1000_5000_metadata = path("$launchDir/results/arborator/999.1000.1000.5000_metadata.tsv")
            def arborator_999_1000_1000_5000_outliers = path("$launchDir/results/arborator/999.1000.1000.5000_outliers.tsv")
            def arborator_999_1000_1000_5000_profile = path("$launchDir/results/arborator/999.1000.1000.5000_profile.tsv")
            def arborator_999_1000_1000_5000_tree = path("$launchDir/results/arborator/999.1000.1000.5000_tree.nwk")

            assert arborator_999_1000_1000_5000_clusters.exists()
            assert arborator_999_1000_1000_5000_loci.exists()
            assert arborator_999_1000_1000_5000_matrix.exists()
            assert arborator_999_1000_1000_5000_metadata.exists()
            assert arborator_999_1000_1000_5000_outliers.exists()
            assert arborator_999_1000_1000_5000_profile.exists()
            assert arborator_999_1000_1000_5000_tree.exists()

            def arborator_5000_5000_5000_10000_clusters = path("$launchDir/results/arborator/5000.5000.5000.10000_clusters.tsv")
            def arborator_5000_5000_5000_10000_loci = path("$launchDir/results/arborator/5000.5000.5000.10000_loci.summary.tsv")
            def arborator_5000_5000_5000_10000_matrix = path("$launchDir/results/arborator/5000.5000.5000.10000_matrix.tsv")
            def arborator_5000_5000_5000_10000_metadata = path("$launchDir/results/arborator/5000.5000.5000.10000_metadata.tsv")
            def arborator_5000_5000_5000_10000_outliers = path("$launchDir/results/arborator/5000.5000.5000.10000_outliers.tsv")
            def arborator_5000_5000_5000_10000_profile = path("$launchDir/results/arborator/5000.5000.5000.10000_profile.tsv")
            def arborator_5000_5000_5000_10000_tree = path("$launchDir/results/arborator/5000.5000.5000.10000_tree.nwk")

            assert arborator_5000_5000_5000_10000_clusters.exists()
            assert arborator_5000_5000_5000_10000_loci.exists()
            assert arborator_5000_5000_5000_10000_matrix.exists()
            assert arborator_5000_5000_5000_10000_metadata.exists()
            assert arborator_5000_5000_5000_10000_outliers.exists()
            assert arborator_5000_5000_5000_10000_profile.exists()
            assert arborator_5000_5000_5000_10000_tree.exists()

            def cluster_summary = path("$launchDir/results/arborator/cluster_summary.tsv")
            def cluster_summary_xlsx = path("$launchDir/results/arborator/cluster_summary.xlsx")
            def metadata_excluded = path("$launchDir/results/arborator/metadata.excluded.tsv")
            def metadata_included = path("$launchDir/results/arborator/metadata.included.tsv")
            def metadata_linelist = path("$launchDir/results/arborator/metadata.linelist.xlsx")
            def run_json = path("$launchDir/results/arborator/run.json")
            def threshold_map = path("$launchDir/results/arborator/threshold_map.json")

            assert cluster_summary.exists()
            assert cluster_summary_xlsx.exists()
            assert metadata_excluded.exists()
            assert metadata_included.exists()
            assert metadata_linelist.exists()
            assert run_json.exists()
            assert threshold_map.exists()

            def arborview_1_1_1_1 = path("$launchDir/results/arborview/1.1.1.1_arborview.html")
            def arborview_1_1_2_2 = path("$launchDir/results/arborview/1.1.2.2_arborview.html")
            def arborview_1_3_3_3 = path("$launchDir/results/arborview/1.3.3.3_arborview.html")
            def arborview_2_4_4_4 = path("$launchDir/results/arborview/2.4.4.4_arborview.html")
            def arborview_5_5_5_21000 = path("$launchDir/results/arborview/5.5.5.21000_arborview.html")
            def arborview_10_10_10_10 = path("$launchDir/results/arborview/10.10.10.10_arborview.html")
            def arborview_70_70_90_110 = path("$launchDir/results/arborview/70.70.90.110_arborview.html")
            def arborview_100_200_300_400 = path("$launchDir/results/arborview/100.200.300.400_arborview.html")
            def arborview_999_1000_1000_5000 = path("$launchDir/results/arborview/999.1000.1000.5000_arborview.html")
            def arborview_5000_5000_5000_10000 = path("$launchDir/results/arborview/5000.5000.5000.10000_arborview.html")

            assert arborview_1_1_1_1.exists()
            assert arborview_1_1_2_2.exists()
            assert arborview_1_3_3_3.exists()
            assert arborview_2_4_4_4.exists()
            assert arborview_5_5_5_21000.exists()
            assert arborview_10_10_10_10.exists()
            assert arborview_70_70_90_110.exists()
            assert arborview_100_200_300_400.exists()
            assert arborview_999_1000_1000_5000.exists()
            assert arborview_5000_5000_5000_10000.exists()

            def iridanext_output = path("$launchDir/results/iridanext.output.json")

            assert iridanext_output.exists()

            // Irida Next Output:
            def iridanext_json = iridanext_output.json
            def iridanext_global = iridanext_json.files.global
            def iridanext_samples = iridanext_json.files.samples
            def iridanext_metadata = iridanext_json.metadata.samples

            assert iridanext_global.findAll { it.path == "arborator/1.1.1.1_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.1.1_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.1.1_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.1.1_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.1.1_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.1.1_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.1.1_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/1.1.2.2_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.2.2_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.2.2_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.2.2_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.2.2_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.2.2_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.1.2.2_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/1.3.3.3_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.3.3.3_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.3.3.3_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.3.3.3_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.3.3.3_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.3.3.3_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/1.3.3.3_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2.4.4.4_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2.4.4.4_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2.4.4.4_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2.4.4.4_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2.4.4.4_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2.4.4.4_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2.4.4.4_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/5.5.5.21000_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5.5.5.21000_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5.5.5.21000_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5.5.5.21000_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5.5.5.21000_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5.5.5.21000_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5.5.5.21000_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/10.10.10.10_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10.10.10.10_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10.10.10.10_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10.10.10.10_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10.10.10.10_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10.10.10.10_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/10.10.10.10_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/70.70.90.110_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/70.70.90.110_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/70.70.90.110_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/70.70.90.110_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/70.70.90.110_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/70.70.90.110_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/70.70.90.110_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/100.200.300.400_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/100.200.300.400_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/100.200.300.400_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/100.200.300.400_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/100.200.300.400_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/100.200.300.400_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/100.200.300.400_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/999.1000.1000.5000_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/999.1000.1000.5000_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/999.1000.1000.5000_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/999.1000.1000.5000_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/999.1000.1000.5000_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/999.1000.1000.5000_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/999.1000.1000.5000_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/5000.5000.5000.10000_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5000.5000.5000.10000_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5000.5000.5000.10000_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5000.5000.5000.10000_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5000.5000.5000.10000_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5000.5000.5000.10000_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/5000.5000.5000.10000_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/cluster_summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/cluster_summary.xlsx" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.excluded.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.included.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.linelist.xlsx" }.size() == 1

            // Check Clusters
            assert arborator_1_1_1_1_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_1_1_1_1_clusters.text.contains("0_ingroup_0\t1.1.1.1|1.1.1.2.3.4")
            assert arborator_1_1_1_1_clusters.text.contains("0_ingroup_1\t1.1.1.1|1.1.1.2.2.3")
            assert arborator_1_1_1_1_clusters.text.contains("0_ingroup_2\t1.1.1.1|1.1.1.1.1.1")
            assert arborator_1_1_1_1_clusters.text.contains("0_ingroup_3\t1.1.1.1|1.1.1.2.2.3")
            assert arborator_1_1_1_1_clusters.text.contains("0_ingroup_4\t1.1.1.1|1.1.1.1.1.2")
            assert arborator_1_1_1_1_clusters.text.contains("0_outgroup_5\t1.1.1.1|5.5.5.6.7.8")
            assert arborator_1_1_1_1_clusters.text.contains("0_outgroup_6\t1.1.1.1|2.2.2.3.4.5")
            assert arborator_1_1_1_1_clusters.text.contains("0_outgroup_7\t1.1.1.1|6.6.6.7.8.9")
            assert arborator_1_1_1_1_clusters.text.contains("0_outgroup_8\t1.1.1.1|3.3.3.4.5.6")
            assert arborator_1_1_1_1_clusters.text.contains("0_outgroup_9\t1.1.1.1|4.4.4.5.6.7")

            assert arborator_1_1_2_2_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_1_1_2_2_clusters.text.contains("1_ingroup_10\t1.1.2.2|1.1.1.1.2.3")
            assert arborator_1_1_2_2_clusters.text.contains("1_ingroup_11\t1.1.2.2|1.1.1.1.3.4")
            assert arborator_1_1_2_2_clusters.text.contains("1_ingroup_12\t1.1.2.2|1.1.1.1.1.1")
            assert arborator_1_1_2_2_clusters.text.contains("1_ingroup_13\t1.1.2.2|1.1.1.1.4.5")
            assert arborator_1_1_2_2_clusters.text.contains("1_ingroup_14\t1.1.2.2|1.1.1.1.1.2")
            assert arborator_1_1_2_2_clusters.text.contains("1_outgroup_15\t1.1.2.2|4.4.4.4.7.8")
            assert arborator_1_1_2_2_clusters.text.contains("1_outgroup_16\t1.1.2.2|2.2.2.2.5.6")
            assert arborator_1_1_2_2_clusters.text.contains("1_outgroup_17\t1.1.2.2|5.5.5.5.8.9")
            assert arborator_1_1_2_2_clusters.text.contains("1_outgroup_18\t1.1.2.2|3.3.3.3.6.7")
            assert arborator_1_1_2_2_clusters.text.contains("1_outgroup_19\t1.1.2.2|6.6.6.6.9.10")

            assert arborator_1_3_3_3_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_1_3_3_3_clusters.text.contains("5_ingroup_50\t1.3.3.3|1.1.1.1.1.1")
            assert arborator_1_3_3_3_clusters.text.contains("5_ingroup_51\t1.3.3.3|1.1.1.1.1.2")
            assert arborator_1_3_3_3_clusters.text.contains("5_ingroup_52\t1.3.3.3|1.1.1.1.1.1")
            assert arborator_1_3_3_3_clusters.text.contains("5_ingroup_53\t1.3.3.3|1.1.1.1.2.3")
            assert arborator_1_3_3_3_clusters.text.contains("5_ingroup_54\t1.3.3.3|1.1.1.1.2.4")
            assert arborator_1_3_3_3_clusters.text.contains("5_outgroup_55\t1.3.3.3|6.6.6.6.7.9")
            assert arborator_1_3_3_3_clusters.text.contains("5_outgroup_56\t1.3.3.3|5.5.5.5.6.8")
            assert arborator_1_3_3_3_clusters.text.contains("5_outgroup_57\t1.3.3.3|2.2.2.2.3.5")
            assert arborator_1_3_3_3_clusters.text.contains("5_outgroup_58\t1.3.3.3|3.3.3.3.4.6")
            assert arborator_1_3_3_3_clusters.text.contains("5_outgroup_59\t1.3.3.3|4.4.4.4.5.7")

            assert arborator_2_4_4_4_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2_4_4_4_clusters.text.contains("3_ingroup_30\t2.4.4.4|1.1.1.1.1.1")
            assert arborator_2_4_4_4_clusters.text.contains("3_ingroup_31\t2.4.4.4|1.1.1.2.2.3")
            assert arborator_2_4_4_4_clusters.text.contains("3_ingroup_32\t2.4.4.4|1.1.1.1.1.2")
            assert arborator_2_4_4_4_clusters.text.contains("3_ingroup_33\t2.4.4.4|1.1.1.1.1.1")
            assert arborator_2_4_4_4_clusters.text.contains("3_ingroup_34\t2.4.4.4|1.1.1.2.3.4")
            assert arborator_2_4_4_4_clusters.text.contains("3_outgroup_35\t2.4.4.4|5.5.5.6.7.8")
            assert arborator_2_4_4_4_clusters.text.contains("3_outgroup_36\t2.4.4.4|6.6.6.7.8.9")
            assert arborator_2_4_4_4_clusters.text.contains("3_outgroup_37\t2.4.4.4|2.2.2.3.4.5")
            assert arborator_2_4_4_4_clusters.text.contains("3_outgroup_38\t2.4.4.4|4.4.4.5.6.7")
            assert arborator_2_4_4_4_clusters.text.contains("3_outgroup_39\t2.4.4.4|3.3.3.4.5.6")

            assert arborator_5_5_5_21000_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_5_5_5_21000_clusters.text.contains("4_ingroup_40\t5.5.5.21000|1.1.1.1.1.1")
            assert arborator_5_5_5_21000_clusters.text.contains("4_ingroup_41\t5.5.5.21000|1.1.1.1.2.3")
            assert arborator_5_5_5_21000_clusters.text.contains("4_ingroup_42\t5.5.5.21000|1.1.1.1.1.2")
            assert arborator_5_5_5_21000_clusters.text.contains("4_ingroup_43\t5.5.5.21000|1.1.1.1.2.4")
            assert arborator_5_5_5_21000_clusters.text.contains("4_ingroup_44\t5.5.5.21000|1.1.1.1.1.1")
            assert arborator_5_5_5_21000_clusters.text.contains("4_outgroup_45\t5.5.5.21000|2.2.2.2.3.5")
            assert arborator_5_5_5_21000_clusters.text.contains("4_outgroup_46\t5.5.5.21000|5.5.5.5.6.8")
            assert arborator_5_5_5_21000_clusters.text.contains("4_outgroup_47\t5.5.5.21000|4.4.4.4.5.7")
            assert arborator_5_5_5_21000_clusters.text.contains("4_outgroup_48\t5.5.5.21000|3.3.3.3.4.6")
            assert arborator_5_5_5_21000_clusters.text.contains("4_outgroup_49\t5.5.5.21000|6.6.6.6.7.9")

            assert arborator_10_10_10_10_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_10_10_10_10_clusters.text.contains("2_ingroup_20\t10.10.10.10|1.1.1.1.1.1")
            assert arborator_10_10_10_10_clusters.text.contains("2_ingroup_21\t10.10.10.10|1.1.1.2.2.3")
            assert arborator_10_10_10_10_clusters.text.contains("2_ingroup_22\t10.10.10.10|1.1.1.1.1.2")
            assert arborator_10_10_10_10_clusters.text.contains("2_ingroup_23\t10.10.10.10|1.1.1.2.2.4")
            assert arborator_10_10_10_10_clusters.text.contains("2_ingroup_24\t10.10.10.10|1.1.1.2.2.5")
            assert arborator_10_10_10_10_clusters.text.contains("2_outgroup_25\t10.10.10.10|5.5.5.6.6.9")
            assert arborator_10_10_10_10_clusters.text.contains("2_outgroup_26\t10.10.10.10|4.4.4.5.5.8")
            assert arborator_10_10_10_10_clusters.text.contains("2_outgroup_27\t10.10.10.10|2.2.2.3.3.6")
            assert arborator_10_10_10_10_clusters.text.contains("2_outgroup_28\t10.10.10.10|6.6.6.7.7.10")
            assert arborator_10_10_10_10_clusters.text.contains("2_outgroup_29\t10.10.10.10|3.3.3.4.4.7")

            assert arborator_70_70_90_110_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_70_70_90_110_clusters.text.contains("6_ingroup_60\t70.70.90.110|1.1.1.1.2.3")
            assert arborator_70_70_90_110_clusters.text.contains("6_ingroup_61\t70.70.90.110|1.1.1.1.2.3")
            assert arborator_70_70_90_110_clusters.text.contains("6_ingroup_62\t70.70.90.110|1.1.1.1.1.1")
            assert arborator_70_70_90_110_clusters.text.contains("6_ingroup_63\t70.70.90.110|1.1.1.1.1.2")
            assert arborator_70_70_90_110_clusters.text.contains("6_ingroup_64\t70.70.90.110|1.1.1.1.3.4")
            assert arborator_70_70_90_110_clusters.text.contains("6_outgroup_65\t70.70.90.110|3.3.3.3.5.6")
            assert arborator_70_70_90_110_clusters.text.contains("6_outgroup_66\t70.70.90.110|5.5.5.5.7.8")
            assert arborator_70_70_90_110_clusters.text.contains("6_outgroup_67\t70.70.90.110|6.6.6.6.8.9")
            assert arborator_70_70_90_110_clusters.text.contains("6_outgroup_68\t70.70.90.110|4.4.4.4.6.7")
            assert arborator_70_70_90_110_clusters.text.contains("6_outgroup_69\t70.70.90.110|2.2.2.2.4.5")

            assert arborator_100_200_300_400_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_100_200_300_400_clusters.text.contains("9_ingroup_90\t100.200.300.400|1.1.1.1.1.1")
            assert arborator_100_200_300_400_clusters.text.contains("9_ingroup_91\t100.200.300.400|1.1.1.2.2.5")
            assert arborator_100_200_300_400_clusters.text.contains("9_ingroup_92\t100.200.300.400|1.1.1.2.2.3")
            assert arborator_100_200_300_400_clusters.text.contains("9_ingroup_93\t100.200.300.400|1.1.1.2.2.4")
            assert arborator_100_200_300_400_clusters.text.contains("9_ingroup_94\t100.200.300.400|1.1.1.1.1.2")
            assert arborator_100_200_300_400_clusters.text.contains("9_outgroup_95\t100.200.300.400|3.3.3.4.4.7")
            assert arborator_100_200_300_400_clusters.text.contains("9_outgroup_96\t100.200.300.400|4.4.4.5.5.8")
            assert arborator_100_200_300_400_clusters.text.contains("9_outgroup_97\t100.200.300.400|6.6.6.7.7.10")
            assert arborator_100_200_300_400_clusters.text.contains("9_outgroup_98\t100.200.300.400|5.5.5.6.6.9")
            assert arborator_100_200_300_400_clusters.text.contains("9_outgroup_99\t100.200.300.400|2.2.2.3.3.6")

            assert arborator_999_1000_1000_5000_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_ingroup_80\t999.1000.1000.5000|1.1.1.1.1.1")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_ingroup_81\t999.1000.1000.5000|1.1.1.1.1.1")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_ingroup_82\t999.1000.1000.5000|1.1.1.1.1.1")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_ingroup_83\t999.1000.1000.5000|1.1.1.1.1.3")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_ingroup_84\t999.1000.1000.5000|1.1.1.1.1.2")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_outgroup_85\t999.1000.1000.5000|6.6.6.6.6.8")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_outgroup_86\t999.1000.1000.5000|2.2.2.2.2.4")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_outgroup_87\t999.1000.1000.5000|4.4.4.4.4.6")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_outgroup_88\t999.1000.1000.5000|3.3.3.3.3.5")
            assert arborator_999_1000_1000_5000_clusters.text.contains("8_outgroup_89\t999.1000.1000.5000|5.5.5.5.5.7")

            assert arborator_5000_5000_5000_10000_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_ingroup_70\t5000.5000.5000.10000|1.1.1.1.1.1")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_ingroup_71\t5000.5000.5000.10000|1.1.1.1.1.2")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_ingroup_72\t5000.5000.5000.10000|1.1.1.1.2.3")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_ingroup_73\t5000.5000.5000.10000|1.1.1.1.2.4")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_ingroup_74\t5000.5000.5000.10000|1.1.1.1.1.1")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_outgroup_75\t5000.5000.5000.10000|3.3.3.3.4.6")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_outgroup_76\t5000.5000.5000.10000|5.5.5.5.6.8")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_outgroup_77\t5000.5000.5000.10000|2.2.2.2.3.5")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_outgroup_78\t5000.5000.5000.10000|6.6.6.6.7.9")
            assert arborator_5000_5000_5000_10000_clusters.text.contains("7_outgroup_79\t5000.5000.5000.10000|4.4.4.4.5.7")

            // Cluster Summary
            assert cluster_summary.text.contains("genomic_address_name\tprovisional_outbreak_code_values\tnational_outbreak_code_values\tnational_outbreak_status_values\tcnphi_post_date_min_value\tcnphi_post_date_max_value\tpredicted_identification_name_values\tpredicted_primary_type_name_values\tcount_members\tmin_dist\tmedian_dist\tmean_dist \tmax_dist\tcount_outliers\toutlier_ids\tcalc_earliest_date_min_value\tcalc_earliest_date_max_value\tcalc_source_type_values\tcount_calc_source_type_animal\tcount_calc_source_type_environmental\tcount_calc_source_type_food\tcount_calc_source_type_human\tcount_calc_source_type_unknown\tgeo_loc_name_state_province_territory_values\tcount_geo_loc_name_state_province_territory_Alberta\tcount_geo_loc_name_state_province_territory_British Columbia\tcount_geo_loc_name_state_province_territory_Manitoba\tcount_geo_loc_name_state_province_territory_New Brunswick\tcount_geo_loc_name_state_province_territory_Newfoundland and Labrador\tcount_geo_loc_name_state_province_territory_Nova Scotia\tcount_geo_loc_name_state_province_territory_Northwest Territories\tcount_geo_loc_name_state_province_territory_Nunavut\tcount_geo_loc_name_state_province_territory_Ontario\tcount_geo_loc_name_state_province_territory_Prince Edward Island\tcount_geo_loc_name_state_province_territory_Quebec\tcount_geo_loc_name_state_province_territory_Saskatchewan\tcount_geo_loc_name_state_province_territory_Yukon")
            assert cluster_summary.text.contains("1.1.1.1\t1,nan\t2501STWGS-01,nan\tclosed,nan\t2025-01-10\t2025-01-17\tSalmonella enterica subsp. enterica\tTyphimurium\t10\t2.0\t89.0\t78.93333333333334\t135.0\t1\t0_outgroup_9\t2025-01-01\t2025-01-10\tAnimal,Environmental,Food,Human,Unknown\t2\t1\t2\t4\t1\tAlberta,British Columbia,Manitoba,New Brunswick,Newfoundland and Labrador,Nova Scotia,Ontario,Prince Edward Island,Quebec,Saskatchewan\t1\t1\t1\t1\t1\t1\t0\t0\t1\t1\t1\t1\t0")
            assert cluster_summary.text.contains("1.1.2.2\t2,nan\t2502SEWGS-01,nan\tclosed,nan\t2025-02-07\t2025-04-04\tSalmonella enterica subsp. enterica\tEnteritidis\t10\t10.0\t79.0\t74.77777777777777\t140.0\t1\t1_outgroup_19\t2025-02-01\t2025-03-11\tAnimal,Environmental,Food,Human\t2\t1\t1\t6\t0\tAlberta,British Columbia,Manitoba,Northwest Territories,Nunavut,Saskatchewan,Yukon\t1\t2\t2\t0\t0\t0\t1\t1\t0\t0\t0\t2\t1")
            assert cluster_summary.text.contains("10.10.10.10\t3,nan\t2503SHWGS-01,nan\tclosed,nan\t2025-03-07\t2025-04-11\tSalmonella enterica\tHeidelberg\t10\t6.0\t86.0\t75.8\t134.0\t0\t\t2025-03-17\t2025-04-01\tAnimal,Environmental,Food,Human\t2\t2\t3\t3\t0\tNew Brunswick,Newfoundland and Labrador,Nova Scotia,Ontario,Prince Edward Island,Quebec\t0\t0\t0\t2\t1\t1\t0\t0\t3\t1\t2\t0\t0")
            assert cluster_summary.text.contains("2.4.4.4\t4,nan\t2504SAL-01,nan\tclosed,nan\t2025-04-11\t2025-05-23\tSalmonella arizonae,Salmonella enterica\tIIIa 51:z36:-\t10\t2.0\t78.0\t71.0\t124.0\t0\t\t2025-04-05\t2025-05-10\tAnimal,Environmental,Food,Human\t2\t2\t1\t5\t0\tNew Brunswick,Newfoundland and Labrador,Northwest Territories,Nova Scotia,Prince Edward Island,Quebec,Yukon\t0\t0\t0\t2\t1\t1\t1\t0\t0\t1\t2\t0\t2")
            assert cluster_summary.text.contains("5.5.5.21000\t5,nan\t2505SAL-01,nan\topen,nan\t2025-05-09\t2025-06-06\tSalmonella enterica,Salmonella arizonae\tI 1,2,12:a:[1,5]|I 1,2,12:a:-\t10\t2.0\t93.0\t75.77777777777777\t138.0\t1\t4_outgroup_49\t2025-05-12\t2025-05-31\tAnimal,Environmental,Food,Human\t2\t3\t3\t2\t0\tAlberta,British Columbia,Newfoundland and Labrador,Northwest Territories,Nova Scotia,Nunavut,Prince Edward Island,Yukon\t2\t1\t0\t0\t1\t1\t1\t2\t0\t1\t0\t0\t1")
            assert cluster_summary.text.contains("1.3.3.3\t6,nan\t2506SAL-01,nan\tclosed,nan\t2025-06-06\t2025-08-08\tSalmonella enterica\tI 1,4,12,27:z41:1,(2),5\t10\t3.0\t83.0\t73.97777777777777\t132.0\t1\t5_outgroup_59\t2025-06-02\t2025-07-06\tAnimal,Environmental,Food,Human\t2\t1\t2\t5\t0\tAlberta,British Columbia,Newfoundland and Labrador,Northwest Territories,Nova Scotia,Nunavut,Prince Edward Island,Saskatchewan,Yukon\t1\t1\t0\t0\t1\t1\t1\t2\t0\t1\t0\t1\t1")
            assert cluster_summary.text.contains("70.70.90.110\t7,nan\t2507monoSTWGS-01,nan\topen,nan\t2025-07-11\t2025-08-29\tSalmonella enterica\tI 1,4,[5],12:i:-\t10\t5.0\t96.0\t81.24444444444444\t131.0\t0\t\t2025-07-07\t2025-08-19\tAnimal,Environmental,Food,Human\t2\t3\t2\t3\t0\tAlberta,British Columbia,Manitoba,New Brunswick,Nova Scotia,Ontario,Prince Edward Island,Quebec,Saskatchewan\t1\t1\t2\t1\t0\t1\t0\t0\t1\t1\t1\t1\t0")
            assert cluster_summary.text.contains("5000.5000.5000.10000\t8,nan\t2509SAL-01,nan\topen,nan\t2025-09-05\t2025-10-24\tSalmonella arizonae\tIIIa 17:g,z51:-\t10\t4.0\t109.0\t90.31111111111112\t135.0\t2\t7_outgroup_78,7_outgroup_79\t2025-08-26\t2025-09-11\tAnimal,Environmental,Food,Human\t2\t2\t2\t4\t0\tAlberta,British Columbia,Newfoundland and Labrador,Northwest Territories,Nunavut,Prince Edward Island,Saskatchewan,Yukon\t1\t1\t0\t0\t1\t0\t2\t2\t0\t1\t0\t1\t1")
            assert cluster_summary.text.contains("999.1000.1000.5000\t9,nan\t2509SAL-02,nan\topen,nan\t2025-09-05\t2025-10-10\tSalmonella bongori\tV 51:y:1,2\t10\t4.0\t111.0\t86.42222222222222\t139.0\t1\t8_outgroup_89\t2025-09-18\t2025-10-19\tAnimal,Environmental,Food,Human\t2\t2\t2\t4\t0\tAlberta,British Columbia,Manitoba,New Brunswick,Nova Scotia,Ontario,Quebec,Saskatchewan\t1\t1\t2\t1\t0\t1\t0\t0\t2\t0\t1\t1\t0")
            assert cluster_summary.text.contains("100.200.300.400\t10,nan\t2511InfantisWGS-01,nan\topen,nan\t2025-11-07\t2025-12-26\tSalmonella enterica\tInfantis\t10\t6.0\t91.0\t81.2\t139.0\t0\t\t2025-11-01\t2025-12-20\tAnimal,Environmental,Food,Human\t2\t2\t2\t4\t0\tManitoba,New Brunswick,Newfoundland and Labrador,Northwest Territories,Nova Scotia,Ontario,Prince Edward Island,Quebec,Saskatchewan,Yukon\t0\t0\t1\t1\t1\t1\t1\t0\t1\t1\t1\t1\t1")

            // Metadata Included (subset):
            assert metadata_included.text.contains("sample_name\tnew_isolates_date\tgas_denovo_cluster_address\tprovisional_outbreak_code\tnational_outbreak_code\tnational_outbreak_status\tnational_outbreak_date_assigned\talternative_isolate_id\tgeo_loc_name_state_province_territory\tpredicted_identification_name\tpredicted_primary_type_name\tcalc_earliest_date\tcalc_source_type\tanatomical_material\tanatomical_part\tbody_product\toriginal_sample_description\tcalc_host_age\thost_gender\thost_date_of_birth_dob\trelated_specimen_primary_id\trelated_specimen_relationship_type\tcomments\tfastmatch_result\tcnphi_post_date\tgenomic_address_name\tsample_puid")
            assert metadata_included.text.contains("0_ingroup_0\t2025-01-07\t1.1.1.1|1.1.1.2.3.4\t1\t2501STWGS-01\tclosed\t2025-01-10\t1\tAlberta\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-01\tHuman\tBlood\tNot Provided\tNot Provided\tHuman;Blood;Not Provided;Not Provided\t78\tFemale\t1947-01-21\tNot Applicable\tNot Applicable\t(?? Salmonella)\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA01")
            assert metadata_included.text.contains("0_ingroup_1\t2025-01-07\t1.1.1.1|1.1.1.2.2.3\t1\t2501STWGS-01\tclosed\t2025-01-10\t2\tBritish Columbia\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-02\tHuman\tNot Provided\tNot Applicable\tFeces\tHuman;Not Provided;Not Applicable;Feces\t85\tFemale\t1940-01-24\tNot Applicable\tNot Applicable\t2025\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA02")
            assert metadata_included.text.contains("0_ingroup_2\t2025-01-07\t1.1.1.1|1.1.1.1.1.1\t1\t2501STWGS-01\tclosed\t2025-01-09\t3\tSaskatchewan\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-03\tAnimal\tNot Provided\tSpleen\tNot Provided\tAnimal;Not Provided;Spleen;Not Provided\t\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tXdr; 2025\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA03")
            assert metadata_included.text.contains("0_ingroup_3\t2025-01-07\t1.1.1.1|1.1.1.2.2.3\t1\t2501STWGS-01\tclosed\t2025-01-09\t4\tManitoba\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-04\tFood\tNot Applicable\tNot Applicable\tNot Applicable\tFood;Not Applicable;Not Applicable;Not Applicable\t\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tPT Resident\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA04")
            assert metadata_included.text.contains("0_ingroup_4\t2025-01-07\t1.1.1.1|1.1.1.1.1.2\t1\t2501STWGS-01\tclosed\t2025-01-10\t5\tOntario\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-05\tEnvironmental\tNot Applicable\tNot Provided\tNot Provided\tEnvironmental;Not Applicable;Not Provided;Not Provided\t\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\t~11 alleles from others\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA05")
            assert metadata_included.text.contains("0_outgroup_5\t2025-01-07\t1.1.1.1|5.5.5.6.7.8\t\t\t\t2025-01-09\t6\tQuebec\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-06\tHuman\tTissue\tmeningeal cluster\tNot Provided\tHuman;Tissue;meningeal cluster;Not Provided\t35\tUnknown\t1990-01-15\tNot Applicable\tNot Applicable\tHomeless/underhoused\t\t2025-01-10\t1.1.1.1\tINXT_SAM_AAAAAAAAA06")
            assert metadata_included.text.contains("0_outgroup_6\t2025-01-14\t1.1.1.1|2.2.2.3.4.5\t\t\t\t2025-01-17\t7\tNew Brunswick\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-07\tHuman\tFluid (cerebrospinal (CSF))\tNot Provided\tNot Provided\tHuman;Fluid (cerebrospinal (CSF));Not Provided;Not Provided\t44\tUnknown\t1981-01-18\tNot Applicable\tNot Applicable\tRecent travel ( usa)\t\t2025-01-17\t1.1.1.1\tINXT_SAM_AAAAAAAAA07")
            assert metadata_included.text.contains("0_outgroup_7\t2025-01-14\t1.1.1.1|6.6.6.7.8.9\t\t\t\t2025-01-17\t8\tNova Scotia\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-08\tAnimal\tNot Applicable\tNot Applicable\tFeces\tAnimal;Not Applicable;Not Applicable;Feces\t\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tDob given as 'n/a'\t\t2025-01-17\t1.1.1.1\tINXT_SAM_AAAAAAAAA08")
            assert metadata_included.text.contains("0_outgroup_8\t2025-01-14\t1.1.1.1|3.3.3.4.5.6\t\t\t\t2025-01-16\t9\tPrince Edward Island\tSalmonella enterica subsp. enterica\tTyphimurium\t2025-01-09\tFood\tNot Applicable\tNot Applicable\tNot Applicable\tFood;Not Applicable;Not Applicable;Not Applicable\t\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tConfirmed\t\t2025-01-17\t1.1.1.1\tINXT_SAM_AAAAAAAAA09")

            // Trees
            assert arborator_1_1_1_1_tree.text.contains("(0_outgroup_7:118.44444444444444,(0_outgroup_5:108.875,(0_outgroup_9:95.85714285714286,(0_outgroup_8:77.33333333333333,(0_outgroup_6:69.2,((0_ingroup_2:10.0,0_ingroup_4:10.0):5.666666666666666,(0_ingroup_0:14.0,(0_ingroup_1:2.0,0_ingroup_3:2.0):12.0):1.666666666666666):53.53333333333334):8.133333333333326):18.523809523809533):13.017857142857139):9.569444444444443);")
            assert arborator_1_1_2_2_tree.text.contains("(1_outgroup_19:118.55555555555556,(1_outgroup_17:93.375,(1_outgroup_15:82.71428571428571,(1_outgroup_18:78.0,(1_outgroup_16:73.6,((1_ingroup_12:10.0,1_ingroup_14:10.0):4.666666666666666,(1_ingroup_13:13.5,(1_ingroup_10:11.0,1_ingroup_11:11.0):2.5):1.166666666666666):58.93333333333333):4.400000000000006):4.714285714285708):10.660714285714292):25.180555555555557);")
            assert arborator_1_3_3_3_tree.text.contains("(5_outgroup_55:109.88888888888889,(5_outgroup_56:99.25,(5_outgroup_59:94.28571428571429,(5_outgroup_58:75.16666666666667,(5_outgroup_57:69.0,((5_ingroup_51:7.5,(5_ingroup_50:3.0,5_ingroup_52:3.0):4.5):3.0,(5_ingroup_53:9.0,5_ingroup_54:9.0):1.5):58.5):6.166666666666671):19.11904761904762):4.964285714285708):10.638888888888886);")
            assert arborator_2_4_4_4_tree.text.contains("(3_outgroup_36:106.77777777777777,(3_outgroup_35:93.125,(3_outgroup_38:85.28571428571429,(3_outgroup_39:77.66666666666667,(3_outgroup_37:61.2,((3_ingroup_32:7.0,(3_ingroup_30:2.0,3_ingroup_33:2.0):5.0):8.5,(3_ingroup_31:11.0,3_ingroup_34:11.0):4.5):45.7):16.46666666666667):7.61904761904762):7.839285714285708):13.652777777777771);")
            assert arborator_5_5_5_21000_tree.text.contains("(4_outgroup_49:112.88888888888889,(4_outgroup_46:107.125,(4_outgroup_47:98.71428571428571,(4_outgroup_48:77.16666666666667,(4_outgroup_45:57.8,((4_ingroup_42:8.0,(4_ingroup_40:2.0,4_ingroup_44:2.0):6.0):3.0,(4_ingroup_41:10.0,4_ingroup_43:10.0):1.0):46.8):19.366666666666674):21.547619047619037):8.410714285714292):5.763888888888886);")
            assert arborator_10_10_10_10_tree.text.contains("(2_outgroup_28:105.22222222222223,(2_outgroup_25:100.375,(2_outgroup_26:96.14285714285714,(2_outgroup_29:82.5,(2_outgroup_27:74.2,((2_ingroup_20:7.0,2_ingroup_22:7.0):8.166666666666666,(2_ingroup_24:9.0,(2_ingroup_21:6.0,2_ingroup_23:6.0):3.0):6.166666666666666):59.03333333333334):8.299999999999997):13.642857142857139):4.232142857142861):4.8472222222222285);")
            assert arborator_70_70_90_110_tree.text.contains("(6_outgroup_67:119.55555555555556,(6_outgroup_66:109.375,(6_outgroup_68:102.71428571428571,(6_outgroup_65:90.83333333333333,(6_outgroup_69:64.2,((6_ingroup_62:10.0,6_ingroup_63:10.0):4.0,(6_ingroup_64:10.5,(6_ingroup_60:5.0,6_ingroup_61:5.0):5.5):3.5):50.2):26.633333333333326):11.88095238095238):6.660714285714292):10.180555555555557);")
            assert arborator_100_200_300_400_tree.text.contains("(9_outgroup_97:118.88888888888889,(9_outgroup_98:107.625,(9_outgroup_96:101.28571428571429,(9_outgroup_95:84.5,(9_outgroup_99:75.0,((9_ingroup_90:8.0,9_ingroup_94:8.0):8.333333333333332,(9_ingroup_91:10.0,(9_ingroup_92:6.0,9_ingroup_93:6.0):4.0):6.333333333333332):58.66666666666667):9.5):16.785714285714292):6.339285714285708):11.263888888888886);")
            assert arborator_999_1000_1000_5000_tree.text.contains("(8_outgroup_85:123.88888888888889,(8_outgroup_89:118.75,(8_outgroup_87:112.85714285714286,(8_outgroup_88:97.33333333333333,(8_outgroup_86:75.6,(8_ingroup_83:9.5,(8_ingroup_84:7.333333333333333,(8_ingroup_82:4.0,(8_ingroup_80:4.0,8_ingroup_81:4.0):0.0):3.333333333333333):2.166666666666667):66.1):21.733333333333334):15.523809523809533):5.892857142857139):5.138888888888886);")
            assert arborator_5000_5000_5000_10000_tree.text.contains("(7_outgroup_78:124.44444444444444,(7_outgroup_76:121.125,(7_outgroup_79:113.28571428571429,(7_outgroup_75:104.0,(7_outgroup_77:92.8,((7_ingroup_71:9.0,(7_ingroup_70:4.0,7_ingroup_74:4.0):5.0):1.5,(7_ingroup_72:9.0,7_ingroup_73:9.0):1.5):82.3):11.200000000000003):9.285714285714292):7.839285714285708):3.319444444444443);")
        }
    }

    test("Outbreak Reporting"){
        tag "pnc"
        tag "pnc_outbreak_reporting"

        config "$baseDir/tests/data/pnc/outbreak-reporting/nextflow.config"

        when {
            params {
                input = "$baseDir/tests/data/pnc/outbreak-reporting/samplesheet.csv"
                outdir = "results"

                ar_config = "$baseDir/tests/data/pnc/outbreak-reporting/arborator.config.json"
                ar_thresholds = "30,25,20,15,10,5"

                tree_distances = "cophenetic"
            }
        }

        then {
            assert workflow.success
            assert path("$launchDir/results").exists()

            // Check that files exist:
            def arborator_2501STWGS_01_clusters = path("$launchDir/results/arborator/2501STWGS-01_clusters.tsv")
            def arborator_2501STWGS_01_loci = path("$launchDir/results/arborator/2501STWGS-01_loci.summary.tsv")
            def arborator_2501STWGS_01_matrix = path("$launchDir/results/arborator/2501STWGS-01_matrix.tsv")
            def arborator_2501STWGS_01_metadata = path("$launchDir/results/arborator/2501STWGS-01_metadata.tsv")
            def arborator_2501STWGS_01_outliers = path("$launchDir/results/arborator/2501STWGS-01_outliers.tsv")
            def arborator_2501STWGS_01_profile = path("$launchDir/results/arborator/2501STWGS-01_profile.tsv")
            def arborator_2501STWGS_01_tree = path("$launchDir/results/arborator/2501STWGS-01_tree.nwk")

            assert arborator_2501STWGS_01_clusters.exists()
            assert arborator_2501STWGS_01_loci.exists()
            assert arborator_2501STWGS_01_matrix.exists()
            assert arborator_2501STWGS_01_metadata.exists()
            assert arborator_2501STWGS_01_outliers.exists()
            assert arborator_2501STWGS_01_profile.exists()
            assert arborator_2501STWGS_01_tree.exists()

            def arborator_2502SEWGS_01_clusters = path("$launchDir/results/arborator/2502SEWGS-01_clusters.tsv")
            def arborator_2502SEWGS_01_loci = path("$launchDir/results/arborator/2502SEWGS-01_loci.summary.tsv")
            def arborator_2502SEWGS_01_matrix = path("$launchDir/results/arborator/2502SEWGS-01_matrix.tsv")
            def arborator_2502SEWGS_01_metadata = path("$launchDir/results/arborator/2502SEWGS-01_metadata.tsv")
            def arborator_2502SEWGS_01_outliers = path("$launchDir/results/arborator/2502SEWGS-01_outliers.tsv")
            def arborator_2502SEWGS_01_profile = path("$launchDir/results/arborator/2502SEWGS-01_profile.tsv")
            def arborator_2502SEWGS_01_tree = path("$launchDir/results/arborator/2502SEWGS-01_tree.nwk")

            assert arborator_2502SEWGS_01_clusters.exists()
            assert arborator_2502SEWGS_01_loci.exists()
            assert arborator_2502SEWGS_01_matrix.exists()
            assert arborator_2502SEWGS_01_metadata.exists()
            assert arborator_2502SEWGS_01_outliers.exists()
            assert arborator_2502SEWGS_01_profile.exists()
            assert arborator_2502SEWGS_01_tree.exists()

            def arborator_2503SHWGS_01_clusters = path("$launchDir/results/arborator/2503SHWGS-01_clusters.tsv")
            def arborator_2503SHWGS_01_loci = path("$launchDir/results/arborator/2503SHWGS-01_loci.summary.tsv")
            def arborator_2503SHWGS_01_matrix = path("$launchDir/results/arborator/2503SHWGS-01_matrix.tsv")
            def arborator_2503SHWGS_01_metadata = path("$launchDir/results/arborator/2503SHWGS-01_metadata.tsv")
            def arborator_2503SHWGS_01_outliers = path("$launchDir/results/arborator/2503SHWGS-01_outliers.tsv")
            def arborator_2503SHWGS_01_profile = path("$launchDir/results/arborator/2503SHWGS-01_profile.tsv")
            def arborator_2503SHWGS_01_tree = path("$launchDir/results/arborator/2503SHWGS-01_tree.nwk")

            assert arborator_2503SHWGS_01_clusters.exists()
            assert arborator_2503SHWGS_01_loci.exists()
            assert arborator_2503SHWGS_01_matrix.exists()
            assert arborator_2503SHWGS_01_metadata.exists()
            assert arborator_2503SHWGS_01_outliers.exists()
            assert arborator_2503SHWGS_01_profile.exists()
            assert arborator_2503SHWGS_01_tree.exists()

            def arborator_2504SAL_01_clusters = path("$launchDir/results/arborator/2504SAL-01_clusters.tsv")
            def arborator_2504SAL_01_loci = path("$launchDir/results/arborator/2504SAL-01_loci.summary.tsv")
            def arborator_2504SAL_01_matrix = path("$launchDir/results/arborator/2504SAL-01_matrix.tsv")
            def arborator_2504SAL_01_metadata = path("$launchDir/results/arborator/2504SAL-01_metadata.tsv")
            def arborator_2504SAL_01_outliers = path("$launchDir/results/arborator/2504SAL-01_outliers.tsv")
            def arborator_2504SAL_01_profile = path("$launchDir/results/arborator/2504SAL-01_profile.tsv")
            def arborator_2504SAL_01_tree = path("$launchDir/results/arborator/2504SAL-01_tree.nwk")

            assert arborator_2504SAL_01_clusters.exists()
            assert arborator_2504SAL_01_loci.exists()
            assert arborator_2504SAL_01_matrix.exists()
            assert arborator_2504SAL_01_metadata.exists()
            assert arborator_2504SAL_01_outliers.exists()
            assert arborator_2504SAL_01_profile.exists()
            assert arborator_2504SAL_01_tree.exists()

            def arborator_2505SAL_01_clusters = path("$launchDir/results/arborator/2505SAL-01_clusters.tsv")
            def arborator_2505SAL_01_loci = path("$launchDir/results/arborator/2505SAL-01_loci.summary.tsv")
            def arborator_2505SAL_01_matrix = path("$launchDir/results/arborator/2505SAL-01_matrix.tsv")
            def arborator_2505SAL_01_metadata = path("$launchDir/results/arborator/2505SAL-01_metadata.tsv")
            def arborator_2505SAL_01_outliers = path("$launchDir/results/arborator/2505SAL-01_outliers.tsv")
            def arborator_2505SAL_01_profile = path("$launchDir/results/arborator/2505SAL-01_profile.tsv")
            def arborator_2505SAL_01_tree = path("$launchDir/results/arborator/2505SAL-01_tree.nwk")

            assert arborator_2505SAL_01_clusters.exists()
            assert arborator_2505SAL_01_loci.exists()
            assert arborator_2505SAL_01_matrix.exists()
            assert arborator_2505SAL_01_metadata.exists()
            assert arborator_2505SAL_01_outliers.exists()
            assert arborator_2505SAL_01_profile.exists()
            assert arborator_2505SAL_01_tree.exists()

            def arborator_2506SAL_01_clusters = path("$launchDir/results/arborator/2506SAL-01_clusters.tsv")
            def arborator_2506SAL_01_loci = path("$launchDir/results/arborator/2506SAL-01_loci.summary.tsv")
            def arborator_2506SAL_01_matrix = path("$launchDir/results/arborator/2506SAL-01_matrix.tsv")
            def arborator_2506SAL_01_metadata = path("$launchDir/results/arborator/2506SAL-01_metadata.tsv")
            def arborator_2506SAL_01_outliers = path("$launchDir/results/arborator/2506SAL-01_outliers.tsv")
            def arborator_2506SAL_01_profile = path("$launchDir/results/arborator/2506SAL-01_profile.tsv")
            def arborator_2506SAL_01_tree = path("$launchDir/results/arborator/2506SAL-01_tree.nwk")

            assert arborator_2506SAL_01_clusters.exists()
            assert arborator_2506SAL_01_loci.exists()
            assert arborator_2506SAL_01_matrix.exists()
            assert arborator_2506SAL_01_metadata.exists()
            assert arborator_2506SAL_01_outliers.exists()
            assert arborator_2506SAL_01_profile.exists()
            assert arborator_2506SAL_01_tree.exists()

            def arborator_2507monoSTWGS_01_clusters = path("$launchDir/results/arborator/2507monoSTWGS-01_clusters.tsv")
            def arborator_2507monoSTWGS_01_loci = path("$launchDir/results/arborator/2507monoSTWGS-01_loci.summary.tsv")
            def arborator_2507monoSTWGS_01_matrix = path("$launchDir/results/arborator/2507monoSTWGS-01_matrix.tsv")
            def arborator_2507monoSTWGS_01_metadata = path("$launchDir/results/arborator/2507monoSTWGS-01_metadata.tsv")
            def arborator_2507monoSTWGS_01_outliers = path("$launchDir/results/arborator/2507monoSTWGS-01_outliers.tsv")
            def arborator_2507monoSTWGS_01_profile = path("$launchDir/results/arborator/2507monoSTWGS-01_profile.tsv")
            def arborator_2507monoSTWGS_01_tree = path("$launchDir/results/arborator/2507monoSTWGS-01_tree.nwk")

            assert arborator_2507monoSTWGS_01_clusters.exists()
            assert arborator_2507monoSTWGS_01_loci.exists()
            assert arborator_2507monoSTWGS_01_matrix.exists()
            assert arborator_2507monoSTWGS_01_metadata.exists()
            assert arborator_2507monoSTWGS_01_outliers.exists()
            assert arborator_2507monoSTWGS_01_profile.exists()
            assert arborator_2507monoSTWGS_01_tree.exists()

            def arborator_2509SAL_01_clusters = path("$launchDir/results/arborator/2509SAL-01_clusters.tsv")
            def arborator_2509SAL_01_loci = path("$launchDir/results/arborator/2509SAL-01_loci.summary.tsv")
            def arborator_2509SAL_01_matrix = path("$launchDir/results/arborator/2509SAL-01_matrix.tsv")
            def arborator_2509SAL_01_metadata = path("$launchDir/results/arborator/2509SAL-01_metadata.tsv")
            def arborator_2509SAL_01_outliers = path("$launchDir/results/arborator/2509SAL-01_outliers.tsv")
            def arborator_2509SAL_01_profile = path("$launchDir/results/arborator/2509SAL-01_profile.tsv")
            def arborator_2509SAL_01_tree = path("$launchDir/results/arborator/2509SAL-01_tree.nwk")

            assert arborator_2509SAL_01_clusters.exists()
            assert arborator_2509SAL_01_loci.exists()
            assert arborator_2509SAL_01_matrix.exists()
            assert arborator_2509SAL_01_metadata.exists()
            assert arborator_2509SAL_01_outliers.exists()
            assert arborator_2509SAL_01_profile.exists()
            assert arborator_2509SAL_01_tree.exists()

            def arborator_2509SAL_02_clusters = path("$launchDir/results/arborator/2509SAL-02_clusters.tsv")
            def arborator_2509SAL_02_loci = path("$launchDir/results/arborator/2509SAL-02_loci.summary.tsv")
            def arborator_2509SAL_02_matrix = path("$launchDir/results/arborator/2509SAL-02_matrix.tsv")
            def arborator_2509SAL_02_metadata = path("$launchDir/results/arborator/2509SAL-02_metadata.tsv")
            def arborator_2509SAL_02_outliers = path("$launchDir/results/arborator/2509SAL-02_outliers.tsv")
            def arborator_2509SAL_02_profile = path("$launchDir/results/arborator/2509SAL-02_profile.tsv")
            def arborator_2509SAL_02_tree = path("$launchDir/results/arborator/2509SAL-02_tree.nwk")

            assert arborator_2509SAL_02_clusters.exists()
            assert arborator_2509SAL_02_loci.exists()
            assert arborator_2509SAL_02_matrix.exists()
            assert arborator_2509SAL_02_metadata.exists()
            assert arborator_2509SAL_02_outliers.exists()
            assert arborator_2509SAL_02_profile.exists()
            assert arborator_2509SAL_02_tree.exists()

            def arborator_2511InfantisWGS_01_clusters = path("$launchDir/results/arborator/2511InfantisWGS-01_clusters.tsv")
            def arborator_2511InfantisWGS_01_loci = path("$launchDir/results/arborator/2511InfantisWGS-01_loci.summary.tsv")
            def arborator_2511InfantisWGS_01_matrix = path("$launchDir/results/arborator/2511InfantisWGS-01_matrix.tsv")
            def arborator_2511InfantisWGS_01_metadata = path("$launchDir/results/arborator/2511InfantisWGS-01_metadata.tsv")
            def arborator_2511InfantisWGS_01_outliers = path("$launchDir/results/arborator/2511InfantisWGS-01_outliers.tsv")
            def arborator_2511InfantisWGS_01_profile = path("$launchDir/results/arborator/2511InfantisWGS-01_profile.tsv")
            def arborator_2511InfantisWGS_01_tree = path("$launchDir/results/arborator/2511InfantisWGS-01_tree.nwk")

            assert arborator_2511InfantisWGS_01_clusters.exists()
            assert arborator_2511InfantisWGS_01_loci.exists()
            assert arborator_2511InfantisWGS_01_matrix.exists()
            assert arborator_2511InfantisWGS_01_metadata.exists()
            assert arborator_2511InfantisWGS_01_outliers.exists()
            assert arborator_2511InfantisWGS_01_profile.exists()
            assert arborator_2511InfantisWGS_01_tree.exists()

            def cluster_summary = path("$launchDir/results/arborator/cluster_summary.tsv")
            def cluster_summary_xlsx = path("$launchDir/results/arborator/cluster_summary.xlsx")
            def metadata_excluded = path("$launchDir/results/arborator/metadata.excluded.tsv")
            def metadata_included = path("$launchDir/results/arborator/metadata.included.tsv")
            def metadata_linelist = path("$launchDir/results/arborator/metadata.linelist.xlsx")
            def run_json = path("$launchDir/results/arborator/run.json")
            def threshold_map = path("$launchDir/results/arborator/threshold_map.json")

            assert cluster_summary.exists()
            assert cluster_summary_xlsx.exists()
            assert metadata_excluded.exists()
            assert metadata_included.exists()
            assert metadata_linelist.exists()
            assert run_json.exists()
            assert threshold_map.exists()

            def arborview_2501STWGS_01 = path("$launchDir/results/arborview/2501STWGS-01_arborview.html")
            def arborview_2502SEWGS_01 = path("$launchDir/results/arborview/2502SEWGS-01_arborview.html")
            def arborview_2503SHWGS_01 = path("$launchDir/results/arborview/2503SHWGS-01_arborview.html")
            def arborview_2504SAL_01 = path("$launchDir/results/arborview/2504SAL-01_arborview.html")
            def arborview_2505SAL_01 = path("$launchDir/results/arborview/2505SAL-01_arborview.html")
            def arborview_2506SAL_01 = path("$launchDir/results/arborview/2506SAL-01_arborview.html")
            def arborview_2507monoSTWGS_01 = path("$launchDir/results/arborview/2507monoSTWGS-01_arborview.html")
            def arborview_2509SAL_01 = path("$launchDir/results/arborview/2509SAL-01_arborview.html")
            def arborview_2509SAL_02 = path("$launchDir/results/arborview/2509SAL-02_arborview.html")
            def arborview_2511InfantisWGS_01 = path("$launchDir/results/arborview/2511InfantisWGS-01_arborview.html")

            assert arborview_2501STWGS_01.exists()
            assert arborview_2502SEWGS_01.exists()
            assert arborview_2503SHWGS_01.exists()
            assert arborview_2504SAL_01.exists()
            assert arborview_2505SAL_01.exists()
            assert arborview_2506SAL_01.exists()
            assert arborview_2507monoSTWGS_01.exists()
            assert arborview_2509SAL_01.exists()
            assert arborview_2509SAL_02.exists()
            assert arborview_2511InfantisWGS_01.exists()

            def iridanext_output = path("$launchDir/results/iridanext.output.json")

            assert iridanext_output.exists()

            // Irida Next Output:
            def iridanext_json = iridanext_output.json
            def iridanext_global = iridanext_json.files.global
            def iridanext_samples = iridanext_json.files.samples
            def iridanext_metadata = iridanext_json.metadata.samples

            assert iridanext_global.findAll { it.path == "arborator/2501STWGS-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2501STWGS-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2501STWGS-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2501STWGS-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2501STWGS-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2501STWGS-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2501STWGS-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2502SEWGS-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2502SEWGS-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2502SEWGS-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2502SEWGS-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2502SEWGS-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2502SEWGS-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2502SEWGS-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2503SHWGS-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2503SHWGS-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2503SHWGS-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2503SHWGS-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2503SHWGS-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2503SHWGS-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2503SHWGS-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2504SAL-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2504SAL-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2504SAL-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2504SAL-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2504SAL-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2504SAL-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2504SAL-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2505SAL-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2505SAL-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2505SAL-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2505SAL-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2505SAL-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2505SAL-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2505SAL-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2506SAL-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2506SAL-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2506SAL-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2506SAL-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2506SAL-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2506SAL-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2506SAL-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2507monoSTWGS-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2507monoSTWGS-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2507monoSTWGS-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2507monoSTWGS-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2507monoSTWGS-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2507monoSTWGS-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2507monoSTWGS-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2509SAL-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2509SAL-02_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-02_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-02_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-02_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-02_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-02_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2509SAL-02_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/2511InfantisWGS-01_clusters.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2511InfantisWGS-01_loci.summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2511InfantisWGS-01_matrix.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2511InfantisWGS-01_metadata.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2511InfantisWGS-01_outliers.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2511InfantisWGS-01_profile.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/2511InfantisWGS-01_tree.nwk" }.size() == 1

            assert iridanext_global.findAll { it.path == "arborator/cluster_summary.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/cluster_summary.xlsx" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.excluded.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.included.tsv" }.size() == 1
            assert iridanext_global.findAll { it.path == "arborator/metadata.linelist.xlsx" }.size() == 1

            // Check Clusters
            assert arborator_2501STWGS_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2501STWGS_01_clusters.text.contains("0_ingroup_0\t2501STWGS-01|1.1.1.2.3.4")
            assert arborator_2501STWGS_01_clusters.text.contains("0_ingroup_1\t2501STWGS-01|1.1.1.2.2.3")
            assert arborator_2501STWGS_01_clusters.text.contains("0_ingroup_2\t2501STWGS-01|1.1.1.1.1.1")
            assert arborator_2501STWGS_01_clusters.text.contains("0_ingroup_3\t2501STWGS-01|1.1.1.2.2.3")
            assert arborator_2501STWGS_01_clusters.text.contains("0_ingroup_4\t2501STWGS-01|1.1.1.1.1.2")

            assert arborator_2502SEWGS_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2502SEWGS_01_clusters.text.contains("1_ingroup_10\t2502SEWGS-01|1.1.1.1.2.3")
            assert arborator_2502SEWGS_01_clusters.text.contains("1_ingroup_11\t2502SEWGS-01|1.1.1.1.3.4")
            assert arborator_2502SEWGS_01_clusters.text.contains("1_ingroup_12\t2502SEWGS-01|1.1.1.1.1.1")
            assert arborator_2502SEWGS_01_clusters.text.contains("1_ingroup_13\t2502SEWGS-01|1.1.1.1.4.5")
            assert arborator_2502SEWGS_01_clusters.text.contains("1_ingroup_14\t2502SEWGS-01|1.1.1.1.1.2")

            assert arborator_2503SHWGS_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2503SHWGS_01_clusters.text.contains("2_ingroup_20\t2503SHWGS-01|1.1.1.1.1.1")
            assert arborator_2503SHWGS_01_clusters.text.contains("2_ingroup_21\t2503SHWGS-01|1.1.1.2.2.3")
            assert arborator_2503SHWGS_01_clusters.text.contains("2_ingroup_22\t2503SHWGS-01|1.1.1.1.1.2")
            assert arborator_2503SHWGS_01_clusters.text.contains("2_ingroup_23\t2503SHWGS-01|1.1.1.2.2.4")
            assert arborator_2503SHWGS_01_clusters.text.contains("2_ingroup_24\t2503SHWGS-01|1.1.1.2.2.5")

            assert arborator_2504SAL_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2504SAL_01_clusters.text.contains("3_ingroup_30\t2504SAL-01|1.1.1.1.1.1")
            assert arborator_2504SAL_01_clusters.text.contains("3_ingroup_31\t2504SAL-01|1.1.1.2.2.3")
            assert arborator_2504SAL_01_clusters.text.contains("3_ingroup_32\t2504SAL-01|1.1.1.1.1.2")
            assert arborator_2504SAL_01_clusters.text.contains("3_ingroup_33\t2504SAL-01|1.1.1.1.1.1")
            assert arborator_2504SAL_01_clusters.text.contains("3_ingroup_34\t2504SAL-01|1.1.1.2.3.4")

            assert arborator_2505SAL_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2505SAL_01_clusters.text.contains("4_ingroup_40\t2505SAL-01|1.1.1.1.1.1")
            assert arborator_2505SAL_01_clusters.text.contains("4_ingroup_41\t2505SAL-01|1.1.1.1.2.3")
            assert arborator_2505SAL_01_clusters.text.contains("4_ingroup_42\t2505SAL-01|1.1.1.1.1.2")
            assert arborator_2505SAL_01_clusters.text.contains("4_ingroup_43\t2505SAL-01|1.1.1.1.2.4")
            assert arborator_2505SAL_01_clusters.text.contains("4_ingroup_44\t2505SAL-01|1.1.1.1.1.1")

            assert arborator_2506SAL_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2506SAL_01_clusters.text.contains("5_ingroup_50\t2506SAL-01|1.1.1.1.1.1")
            assert arborator_2506SAL_01_clusters.text.contains("5_ingroup_51\t2506SAL-01|1.1.1.1.1.2")
            assert arborator_2506SAL_01_clusters.text.contains("5_ingroup_52\t2506SAL-01|1.1.1.1.1.1")
            assert arborator_2506SAL_01_clusters.text.contains("5_ingroup_53\t2506SAL-01|1.1.1.1.2.3")
            assert arborator_2506SAL_01_clusters.text.contains("5_ingroup_54\t2506SAL-01|1.1.1.1.2.4")

            assert arborator_2507monoSTWGS_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2507monoSTWGS_01_clusters.text.contains("6_ingroup_60\t2507monoSTWGS-01|1.1.1.1.2.3")
            assert arborator_2507monoSTWGS_01_clusters.text.contains("6_ingroup_61\t2507monoSTWGS-01|1.1.1.1.2.3")
            assert arborator_2507monoSTWGS_01_clusters.text.contains("6_ingroup_62\t2507monoSTWGS-01|1.1.1.1.1.1")
            assert arborator_2507monoSTWGS_01_clusters.text.contains("6_ingroup_63\t2507monoSTWGS-01|1.1.1.1.1.2")
            assert arborator_2507monoSTWGS_01_clusters.text.contains("6_ingroup_64\t2507monoSTWGS-01|1.1.1.1.3.4")

            assert arborator_2509SAL_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2509SAL_01_clusters.text.contains("7_ingroup_70\t2509SAL-01|1.1.1.1.1.1")
            assert arborator_2509SAL_01_clusters.text.contains("7_ingroup_71\t2509SAL-01|1.1.1.1.1.2")
            assert arborator_2509SAL_01_clusters.text.contains("7_ingroup_72\t2509SAL-01|1.1.1.1.2.3")
            assert arborator_2509SAL_01_clusters.text.contains("7_ingroup_73\t2509SAL-01|1.1.1.1.2.4")
            assert arborator_2509SAL_01_clusters.text.contains("7_ingroup_74\t2509SAL-01|1.1.1.1.1.1")

            assert arborator_2509SAL_02_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2509SAL_02_clusters.text.contains("8_ingroup_80\t2509SAL-02|1.1.1.1.1.1")
            assert arborator_2509SAL_02_clusters.text.contains("8_ingroup_81\t2509SAL-02|1.1.1.1.1.1")
            assert arborator_2509SAL_02_clusters.text.contains("8_ingroup_82\t2509SAL-02|1.1.1.1.1.1")
            assert arborator_2509SAL_02_clusters.text.contains("8_ingroup_83\t2509SAL-02|1.1.1.1.1.3")
            assert arborator_2509SAL_02_clusters.text.contains("8_ingroup_84\t2509SAL-02|1.1.1.1.1.2")

            assert arborator_2511InfantisWGS_01_clusters.text.contains("sample_name\tgas_denovo_cluster_address")
            assert arborator_2511InfantisWGS_01_clusters.text.contains("9_ingroup_90\t2511InfantisWGS-01|1.1.1.1.1.1")
            assert arborator_2511InfantisWGS_01_clusters.text.contains("9_ingroup_91\t2511InfantisWGS-01|1.1.1.2.2.5")
            assert arborator_2511InfantisWGS_01_clusters.text.contains("9_ingroup_92\t2511InfantisWGS-01|1.1.1.2.2.3")
            assert arborator_2511InfantisWGS_01_clusters.text.contains("9_ingroup_93\t2511InfantisWGS-01|1.1.1.2.2.4")
            assert arborator_2511InfantisWGS_01_clusters.text.contains("9_ingroup_94\t2511InfantisWGS-01|1.1.1.1.1.2")

            // Cluster Summary
            assert cluster_summary.text.contains("national_outbreak_code\tnational_outbreak_status_values\tcnphi_post_date_min_value\tcnphi_post_date_max_value\tgenomic_address_name_values\tpredicted_identification_name_values\tpredicted_primary_type_name_values\tcount_members\tmin_dist\tmedian_dist\tmean_dist\tmax_dist\tcalc_earliest_date_min_value\tcalc_earliest_date_max_value\tcalc_source_type_values\tcount_calc_source_type_Animal\tcount_calc_source_type_Environmental\tcount_calc_source_type_Food\tcount_calc_source_type_Human\tcount_calc_source_type_Unknown\tgeo_loc_name_state_province_territory_values\tcount_geo_loc_name_state_province_territory_Alberta\tcount_geo_loc_name_state_province_territory_British Columbia\tcount_geo_loc_name_state_province_territory_Manitoba\tcount_geo_loc_name_state_province_territory_New Brunswick\tcount_geo_loc_name_state_province_territory_Newfoundland and Labrador\tcount_geo_loc_name_state_province_territory_Nova Scotia\tcount_geo_loc_name_state_province_territory_Nunavut\tcount_geo_loc_name_state_province_territory_Ontario\tcount_geo_loc_name_state_province_territory_Prince Edward Island\tcount_geo_loc_name_state_province_territory_Quebec\tcount_geo_loc_name_state_province_territory_Saskatchewan\tcount_geo_loc_name_state_province_territory_Northwest Territories\tcount_geo_loc_name_state_province_territory_Yukon")
            assert cluster_summary.text.contains("2501STWGS-01\tclosed\t2025-01-10\t2025-01-10\t1.1.1.1\tSalmonella enterica subsp. enterica\tTyphimurium\t5\t2.0\t15.0\t13.4\t18.0\t2025-01-01\t2025-01-05\tAnimal,Environmental,Food,Human\t1\t1\t1\t2\t0\tAlberta,British Columbia,Manitoba,Ontario,Saskatchewan\t1\t1\t1\t0\t0\t0\t0\t1\t0\t0\t1\t0\t0")
            assert cluster_summary.text.contains("2502SEWGS-01\tclosed\t2025-02-07\t2025-03-07\t1.1.2.2\tSalmonella enterica subsp. enterica\tEnteritidis\t5\t10.0\t13.0\t13.6\t20.0\t2025-02-01\t2025-03-01\tAnimal,Food,Human\t1\t0\t1\t3\t0\tAlberta,British Columbia,Northwest Territories,Nunavut,Yukon\t1\t1\t0\t0\t0\t0\t1\t0\t0\t0\t0\t1\t1")
            assert cluster_summary.text.contains("2503SHWGS-01\tclosed\t2025-03-07\t2025-03-28\t10.10.10.10\tSalmonella enterica\tHeidelberg\t5\t6.0\t13.5\t12.2\t17.0\t2025-03-17\t2025-03-22\tAnimal,Environmental,Food,Human\t1\t1\t2\t1\t0\tNew Brunswick,Ontario,Quebec\t0\t0\t0\t1\t0\t0\t0\t2\t0\t2\t0\t0\t0")
            assert cluster_summary.text.contains("2504SAL-01\tclosed\t2025-04-11\t2025-05-02\t2.4.4.4\tSalmonella arizonae\tIIIa 51:z36:-\t5\t2.0\t13.5\t12.0\t18.0\t2025-04-05\t2025-04-24\tAnimal,Environmental,Food,Human\t1\t2\t1\t1\t0\tNew Brunswick,Nova Scotia,Prince Edward Island,Quebec,Yukon\t0\t0\t0\t1\t0\t1\t0\t0\t1\t1\t0\t0\t1")
            assert cluster_summary.text.contains("2505SAL-01\topen\t2025-05-09\t2025-05-23\t5.5.5.21000\tSalmonella enterica,Salmonella arizonae\tI 1,2,12:a:[1,5]|I 1,2,12:a:-\t5\t2.0\t9.5\t9.4\t13.0\t2025-05-12\t2025-05-15\tAnimal,Environmental,Food\t1\t2\t2\t0\t0\tAlberta,Newfoundland and Labrador,Nova Scotia,Nunavut,Prince Edward Island\t1\t0\t0\t0\t1\t1\t1\t0\t1\t0\t0\t0\t0")
            assert cluster_summary.text.contains("2506SAL-01\tclosed\t2025-06-06\t2025-06-27\t1.3.3.3\tSalmonella enterica\tI 1,4,12,27:z41:1,(2),5\t5\t3.0\t9.0\t9.0\t13.0\t2025-06-02\t2025-06-21\tAnimal,Environmental,Food,Human\t1\t1\t1\t2\t0\tNewfoundland and Labrador,Northwest Territories,Nova Scotia,Prince Edward Island,Yukon\t0\t0\t0\t0\t1\t1\t0\t0\t1\t0\t0\t1\t1")
            assert cluster_summary.text.contains("2507monoSTWGS-01\topen\t2025-07-11\t2025-07-18\t70.70.90.110\tSalmonella enterica\tI 1,4,[5],12:i:-\t5\t5.0\t12.5\t12.0\t19.0\t2025-07-07\t2025-07-25\tAnimal,Environmental,Food,Human\t1\t1\t1\t2\t0\tAlberta,British Columbia,Manitoba,Ontario,Saskatchewan\t1\t1\t1\t0\t0\t0\t0\t1\t0\t0\t1\t0\t0")
            assert cluster_summary.text.contains("2509SAL-01\topen\t2025-09-05\t2025-09-19\t5000.5000.5000.10000\tSalmonella arizonae\tIIIa 17:g,z51:-\t5\t4.0\t10.0\t9.4\t12.0\t2025-08-26\t2025-09-04\tAnimal,Human\t1\t0\t0\t4\t0\tNewfoundland and Labrador,Northwest Territories,Nunavut,Prince Edward Island,Yukon\t0\t0\t0\t0\t1\t0\t1\t0\t1\t0\t0\t1\t1")
            assert cluster_summary.text.contains("2509SAL-02\topen\t2025-09-05\t2025-09-19\t999.1000.1000.5000\tSalmonella bongori\tV 51:y:1,2\t5\t4.0\t7.5\t7.2\t13.0\t2025-09-18\t2025-09-29\tAnimal,Human\t1\t0\t0\t4\t0\tAlberta,British Columbia,Manitoba,Ontario,Quebec\t1\t1\t1\t0\t0\t0\t0\t1\t0\t1\t0\t0\t0")
            assert cluster_summary.text.contains("2511InfantisWGS-01\topen\t2025-11-07\t2025-12-05\t100.200.300.400\tSalmonella enterica\tInfantis\t5\t6.0\t12.5\t13.2\t24.0\t2025-11-01\t2025-11-27\tAnimal,Environmental,Food,Human\t1\t1\t1\t2\t0\tManitoba,New Brunswick,Ontario,Quebec,Saskatchewan\t0\t0\t1\t1\t0\t0\t0\t1\t0\t1\t1\t0\t0")

            // Metadata Included (subset):
            assert metadata_included.text.contains("cnphi_post_date\tsample_name\talternative_isolate_id\tgeo_loc_name_state_province_territory\tpredicted_identification_name\tpredicted_primary_type_name\tsubmitted_organism\tsubmitted_organism_details\tsample_received_date_nml\tsample_received_date_collaborator\tisolation_date\tsample_collection_date\tisolate_received_date\tcalc_earliest_date\tcalc_source_type\tanatomical_material\tanatomical_part\tbody_product\tanimal_source_of_food\tfood_product\tfood_product_properties\tfood_packing_medium\tfood_quality_date\tfood_packaging_date\tfood_product_origin_geo_loc_name_country\tlabel_claim\tenvironmental_site\tenvironmental_material\tanimal_or_plant_population\thost_scientific_name\thost_common_name\tcollection_device\tcollection_method\toriginal_sample_description\thost_gender\tcalc_host_age\tnational_outbreak_code\tnational_outbreak_status\teventid\trelated_specimen_primary_id\trelated_specimen_relationship_type\tcomments\tfastmatch_result\tgenomic_address_name\tgas_denovo_cluster_address\tsample_puid")
            assert metadata_included.text.contains("2025-01-10\t0_ingroup_0\t1\tAlberta\tSalmonella enterica subsp. enterica\tTyphimurium\tSalmonella\tNot Collected\tNot Applicable\tNot Provided\t2025-01-05\t2025-01-03\t2025-01-08\t2025-01-01\tHuman\tBlood\tNot Provided\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tHomo sapiens\tHuman\tNot Provided\tOTHER - please describe in original sample description\tHuman;Blood;Not Provided;Not Provided\tFemale\t78\t2501STWGS-01\tclosed\t25-001\tNot Applicable\tNot Applicable\t(?? Salmonella)\t\t1.1.1.1\t2501STWGS-01|1.1.1.2.3.4\tINXT_SAM_AAAAAAAAA01")
            assert metadata_included.text.contains("2025-01-10\t0_ingroup_1\t2\tBritish Columbia\tSalmonella enterica subsp. enterica\tTyphimurium\tSalmonella\tNot Collected\tNot Applicable\tNot Provided\t2025-01-06\t2025-01-04\t2025-01-09\t2025-01-02\tHuman\tNot Provided\tNot Applicable\tFeces\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tHomo sapiens\tHuman\tNot Provided\tSwabbing\tHuman;Not Provided;Not Applicable;Feces\tFemale\t85\t2501STWGS-01\tclosed\t25-001\tNot Applicable\tNot Applicable\t2025\t\t1.1.1.1\t2501STWGS-01|1.1.1.2.2.3\tINXT_SAM_AAAAAAAAA02")
            assert metadata_included.text.contains("2025-01-10\t0_ingroup_2\t3\tSaskatchewan\tSalmonella enterica subsp. enterica\tTyphimurium\tSalmonella\tNot Collected\tNot Applicable\tNot Provided\t2025-01-07\t2025-01-05\t2025-01-10\t2025-01-03\tAnimal\tNot Provided\tSpleen\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Provided\tNot Applicable\tNot Applicable\tNot Provided\tGallus gallus\tChicken\tNot Provided\tNot Provided\tAnimal;Not Provided;Spleen;Not Provided\tNot Provided\t\t2501STWGS-01\tclosed\t25-001\tNot Applicable\tNot Applicable\tXdr; 2025\t\t1.1.1.1\t2501STWGS-01|1.1.1.1.1.1\tINXT_SAM_AAAAAAAAA03")
            assert metadata_included.text.contains("2025-01-10\t0_ingroup_3\t4\tManitoba\tSalmonella enterica subsp. enterica\tTyphimurium\tSalmonella\tNot Applicable\tNot Applicable\tNot Provided\t2025-01-08\t2025-01-06\t2025-01-11\t2025-01-04\tFood\tNot Applicable\tNot Applicable\tNot Applicable\tNot Collected\tNot Collected\tNot Collected\tNot Collected\tNot Collected\tNot Collected\tCanada\tNot Applicable\tOTHER - please describe in original sample description field\tBoot cover\t\tNot Provided\tNot Provided\tNot Provided\tNot Provided\tFood;Not Applicable;Not Applicable;Not Applicable\tNot Applicable\t\t2501STWGS-01\tclosed\t25-001\tNot Applicable\tNot Applicable\tPT Resident\t\t1.1.1.1\t2501STWGS-01|1.1.1.2.2.3\tINXT_SAM_AAAAAAAAA04")
            assert metadata_included.text.contains("2025-01-10\t0_ingroup_4\t5\tOntario\tSalmonella enterica subsp. enterica\tTyphimurium\tSalmonella\tNot Applicable\tNot Applicable\tNot Provided\t2025-01-09\t2025-01-07\t2025-01-12\t2025-01-05\tEnvironmental\tNot Applicable\tNot Provided\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Provided\tNot Applicable\tNot Applicable\tNot Provided\tNot Applicable\tNot Applicable\tNot Provided\tNot Provided\tEnvironmental;Not Applicable;Not Provided;Not Provided\tNot Applicable\t\t2501STWGS-01\tclosed\t25-001\tNot Applicable\tNot Applicable\t~11 alleles from others\t\t1.1.1.1\t2501STWGS-01|1.1.1.1.1.2\tINXT_SAM_AAAAAAAAA05")
            assert metadata_included.text.contains("2025-02-07\t1_ingroup_10\t11.42529704\tYukon\tSalmonella enterica subsp. enterica\tEnteritidis\tSalmonella\tNot Provided\tNot Applicable\tNot Provided\t2025-02-05\t2025-02-03\t2025-02-08\t2025-02-01\tHuman\tBlood\tNot Provided\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tHomo sapiens\tHuman\tNot Provided\tOTHER - please describe in original sample description\tHuman;Blood;Not Provided;Not Provided\tMale\t33\t2502SEWGS-01\tclosed\t25-002\tNot Applicable\tNot Applicable\t2025\t\t1.1.2.2\t2502SEWGS-01|1.1.1.1.2.3\tINXT_SAM_AAAAAAAAA11")
            assert metadata_included.text.contains("2025-02-14\t1_ingroup_11\t12.93911574\tNorthwest Territories\tSalmonella enterica subsp. enterica\tEnteritidis\tSalmonella\tNot Provided\tNot Applicable\tNot Provided\t2025-02-12\t2025-02-10\t2025-02-15\t2025-02-08\tHuman\tNot Provided\tLung\tFeces\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tHomo sapiens\tHuman\tNot Provided\tSwabbing\tHuman;Not Provided;Lung;Feces\tMale\t60\t2502SEWGS-01\tclosed\t25-002\tNot Applicable\tNot Applicable\tXdr; 2025\t\t1.1.2.2\t2502SEWGS-01|1.1.1.1.3.4\tINXT_SAM_AAAAAAAAA12")
            assert metadata_included.text.contains("2025-02-21\t1_ingroup_12\t13.11566743\tNunavut\tSalmonella enterica subsp. enterica\tEnteritidis\tSalmonella\tNot Collected\tNot Applicable\tNot Provided\t2025-02-18\t2025-02-16\t2025-02-21\t2025-02-14\tAnimal\tNot Applicable\tSpleen\tNot Provided\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Applicable\tNot Provided\tNot Applicable\tNot Applicable\tCow\tSus scrofa\tPig\tNot Provided\tOTHER - please describe in original sample description\tAnimal;Not Applicable;Spleen;Not Provided\tNot Provided\t\t2502SEWGS-01\tclosed\t25-002\tNot Applicable\tNot Applicable\tPT Resident\t\t1.1.2.2\t2502SEWGS-01|1.1.1.1.1.1\tINXT_SAM_AAAAAAAAA13")
            assert metadata_included.text.contains("2025-02-28\t1_ingroup_13\t14.62079496\tAlberta\tSalmonella enterica subsp. enterica\tEnteritidis\tSalmonella\tNot Applicable\tNot Applicable\tNot Provided\t2025-02-28\t2025-02-26\t2025-03-03\t2025-02-24\tFood\tNot Applicable\tNot Applicable\tNot Applicable\tNot Collected\tNot Collected\tNot Collected\tNot Collected\tNot Collected\tNot Collected\tCote d'ivoire\tNot Applicable\tDairy; Fluid holding Tank\tDust\t\tNot Provided\tNot Provided\tNot Provided\tNot Provided\tFood;Not Applicable;Not Applicable;Not Applicable\tNot Applicable\t\t2502SEWGS-01\tclosed\t25-002\tNot Applicable\tNot Applicable\t~11 alleles from others\t\t1.1.2.2\t2502SEWGS-01|1.1.1.1.4.5\tINXT_SAM_AAAAAAAAA14")

            // Trees
            assert arborator_2501STWGS_01_tree.text.contains("((0_ingroup_2:10.0,0_ingroup_4:10.0):5.666666666666666,(0_ingroup_0:14.0,(0_ingroup_1:2.0,0_ingroup_3:2.0):12.0):1.666666666666666);")
            assert arborator_2502SEWGS_01_tree.text.contains("((1_ingroup_12:10.0,1_ingroup_14:10.0):4.666666666666666,(1_ingroup_13:13.5,(1_ingroup_10:11.0,1_ingroup_11:11.0):2.5):1.166666666666666);")
            assert arborator_2503SHWGS_01_tree.text.contains("((2_ingroup_20:7.0,2_ingroup_22:7.0):8.166666666666666,(2_ingroup_24:9.0,(2_ingroup_21:6.0,2_ingroup_23:6.0):3.0):6.166666666666666);")
            assert arborator_2504SAL_01_tree.text.contains("((3_ingroup_32:7.0,(3_ingroup_30:2.0,3_ingroup_33:2.0):5.0):8.5,(3_ingroup_31:11.0,3_ingroup_34:11.0):4.5);")
            assert arborator_2505SAL_01_tree.text.contains("((4_ingroup_42:8.0,(4_ingroup_40:2.0,4_ingroup_44:2.0):6.0):3.0,(4_ingroup_41:10.0,4_ingroup_43:10.0):1.0);")
            assert arborator_2506SAL_01_tree.text.contains("((5_ingroup_51:7.5,(5_ingroup_50:3.0,5_ingroup_52:3.0):4.5):3.0,(5_ingroup_53:9.0,5_ingroup_54:9.0):1.5);")
            assert arborator_2507monoSTWGS_01_tree.text.contains("((6_ingroup_62:10.0,6_ingroup_63:10.0):4.0,(6_ingroup_64:10.5,(6_ingroup_60:5.0,6_ingroup_61:5.0):5.5):3.5);")
            assert arborator_2509SAL_01_tree.text.contains("((7_ingroup_71:9.0,(7_ingroup_70:4.0,7_ingroup_74:4.0):5.0):1.5,(7_ingroup_72:9.0,7_ingroup_73:9.0):1.5);")
            assert arborator_2509SAL_02_tree.text.contains("(8_ingroup_83:9.5,(8_ingroup_84:7.333333333333333,(8_ingroup_82:4.0,(8_ingroup_80:4.0,8_ingroup_81:4.0):0.0):3.333333333333333):2.166666666666667);")
            assert arborator_2511InfantisWGS_01_tree.text.contains("((9_ingroup_90:8.0,9_ingroup_94:8.0):8.333333333333332,(9_ingroup_91:10.0,(9_ingroup_92:6.0,9_ingroup_93:6.0):4.0):6.333333333333332);")
        }
    }
}
